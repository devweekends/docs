---
title: "Amazon CloudWatch"
description: "Master CloudWatch metrics, logs, alarms, dashboards, Log Insights, and operational monitoring"
icon: "chart-line"
---

<Frame>
  <img src="/images/aws/cloudwatch-deep-dive.svg" alt="CloudWatch Deep Dive" />
</Frame>

## Module Overview

<Info>
**Estimated Time**: 4-5 hours | **Difficulty**: Intermediate | **Prerequisites**: Core Concepts
</Info>

Amazon CloudWatch is the unified monitoring and observability service for AWS. This module provides a comprehensive deep-dive into CloudWatch capabilities for production monitoring.

**What You'll Learn:**
- CloudWatch Metrics (built-in and custom)
- CloudWatch Logs and Log Insights
- CloudWatch Alarms and composite alarms
- Dashboards and visualization
- CloudWatch Synthetics (canaries)
- CloudWatch Contributor Insights
- CloudWatch Anomaly Detection
- Cross-account and cross-region monitoring

---

## CloudWatch Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CloudWatch Architecture                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Data Sources                        CloudWatch                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ EC2, RDS,    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         METRICS               â”‚ â”‚
â”‚   â”‚ Lambda, etc. â”‚   Auto-collected  â”‚  â€¢ Standard (5-min)           â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â€¢ Detailed (1-min)           â”‚ â”‚
â”‚                                      â”‚  â€¢ High-res (1-sec)           â”‚ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”‚ Applications â”‚   PutMetricData   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ (Custom)     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚      CUSTOM METRICS           â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â€¢ Business KPIs              â”‚ â”‚
â”‚                                      â”‚  â€¢ App-specific metrics       â”‚ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”‚ Lambda, ECS, â”‚   Auto-collected  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ EC2, VPC     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          LOGS                 â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â€¢ Log Groups                 â”‚ â”‚
â”‚                                      â”‚  â€¢ Log Streams                â”‚ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â€¢ Log Insights               â”‚ â”‚
â”‚   â”‚ Applications â”‚   Agent/SDK       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   Processing & Actions               â”‚         ALARMS                â”‚ â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚  â€¢ Metric Alarms              â”‚ â”‚
â”‚   â€¢ Alarms â†’ SNS, Auto Scaling       â”‚  â€¢ Composite Alarms           â”‚ â”‚
â”‚   â€¢ EventBridge â†’ Lambda, etc.       â”‚  â€¢ Anomaly Detection          â”‚ â”‚
â”‚   â€¢ Dashboards â†’ Visualization       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â€¢ Contributor Insights                                               â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                                      â”‚       DASHBOARDS              â”‚ â”‚
â”‚                                      â”‚  â€¢ Widgets                    â”‚ â”‚
â”‚                                      â”‚  â€¢ Cross-account view         â”‚ â”‚
â”‚                                      â”‚  â€¢ Sharing                    â”‚ â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CloudWatch Metrics

### Built-in Metrics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Built-in Metrics by Service                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   EC2 (Basic - 5 min | Detailed - 1 min):                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚
â”‚   â€¢ CPUUtilization       â€¢ DiskReadOps         â€¢ DiskWriteOps          â”‚
â”‚   â€¢ NetworkIn            â€¢ NetworkOut          â€¢ StatusCheckFailed     â”‚
â”‚   âš ï¸ Memory NOT included (use CloudWatch Agent)                        â”‚
â”‚                                                                         â”‚
â”‚   Lambda:                                                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€                                                               â”‚
â”‚   â€¢ Invocations          â€¢ Duration            â€¢ Errors                â”‚
â”‚   â€¢ Throttles            â€¢ ConcurrentExec      â€¢ UnreservedConcurrent  â”‚
â”‚   â€¢ IteratorAge (streams)                                              â”‚
â”‚                                                                         â”‚
â”‚   RDS:                                                                  â”‚
â”‚   â”€â”€â”€â”€                                                                  â”‚
â”‚   â€¢ CPUUtilization       â€¢ DatabaseConnections â€¢ FreeableMemory        â”‚
â”‚   â€¢ ReadIOPS             â€¢ WriteIOPS           â€¢ ReadLatency           â”‚
â”‚   â€¢ WriteLatency         â€¢ FreeStorageSpace                            â”‚
â”‚                                                                         â”‚
â”‚   DynamoDB:                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚   â€¢ ConsumedRCU          â€¢ ConsumedWCU         â€¢ ProvisionedRCU        â”‚
â”‚   â€¢ ProvisionedWCU       â€¢ ThrottledRequests   â€¢ SystemErrors          â”‚
â”‚   â€¢ ReturnedItemCount    â€¢ SuccessfulRequestLatency                    â”‚
â”‚                                                                         â”‚
â”‚   Application Load Balancer:                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚   â€¢ RequestCount         â€¢ TargetResponseTime  â€¢ HTTPCode_Target_2XX   â”‚
â”‚   â€¢ HTTPCode_Target_4XX  â€¢ HTTPCode_Target_5XX â€¢ HealthyHostCount      â”‚
â”‚   â€¢ UnHealthyHostCount   â€¢ ActiveConnectionCount                       â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Metric Dimensions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Metric Dimensions                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Metrics are uniquely identified by:                                   â”‚
â”‚   Namespace + Metric Name + Dimensions                                  â”‚
â”‚                                                                         â”‚
â”‚   Example:                                                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚   Namespace: AWS/EC2                                                    â”‚
â”‚   Metric: CPUUtilization                                                â”‚
â”‚   Dimensions: InstanceId=i-1234567890abcdef0                           â”‚
â”‚                                                                         â”‚
â”‚   Each unique combination creates a separate time series:               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  AWS/EC2 | CPUUtilization | InstanceId=i-abc123  â†’ Time Series 1â”‚  â”‚
â”‚   â”‚  AWS/EC2 | CPUUtilization | InstanceId=i-def456  â†’ Time Series 2â”‚  â”‚
â”‚   â”‚  AWS/EC2 | CPUUtilization | AutoScalingGroup=web â†’ Time Series 3â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   Aggregation Example:                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚   Query by ASG dimension to get aggregate across all instances:        â”‚
â”‚   aws cloudwatch get-metric-statistics \                               â”‚
â”‚     --namespace AWS/EC2 \                                              â”‚
â”‚     --metric-name CPUUtilization \                                     â”‚
â”‚     --dimensions Name=AutoScalingGroupName,Value=my-asg               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Custom Metrics

```python
import boto3
from datetime import datetime
from decimal import Decimal

cloudwatch = boto3.client('cloudwatch')

def publish_business_metric(metric_name: str, value: float, 
                            dimensions: list = None):
    """
    Publish custom business metric to CloudWatch.
    
    Cost: $0.30 per metric per month (first 10,000)
    """
    metric_data = {
        'MetricName': metric_name,
        'Value': value,
        'Unit': 'Count',
        'Timestamp': datetime.utcnow(),
        'StorageResolution': 60  # Standard resolution (60 = 1 min)
    }
    
    if dimensions:
        metric_data['Dimensions'] = dimensions
    
    cloudwatch.put_metric_data(
        Namespace='MyApplication',
        MetricData=[metric_data]
    )

# Example: Track orders placed
publish_business_metric(
    metric_name='OrdersPlaced',
    value=1,
    dimensions=[
        {'Name': 'Environment', 'Value': 'production'},
        {'Name': 'Region', 'Value': 'us-east-1'},
        {'Name': 'ProductCategory', 'Value': 'electronics'}
    ]
)

# High-resolution metric (1-second granularity)
def publish_high_res_metric(metric_name: str, value: float):
    """High-resolution metric for real-time monitoring."""
    cloudwatch.put_metric_data(
        Namespace='MyApplication/HighFrequency',
        MetricData=[{
            'MetricName': metric_name,
            'Value': value,
            'Unit': 'Milliseconds',
            'Timestamp': datetime.utcnow(),
            'StorageResolution': 1  # 1-second resolution
        }]
    )

# Batch publish (up to 1000 per request, 1MB max)
def publish_batch_metrics(metrics: list):
    """Efficiently publish multiple metrics."""
    cloudwatch.put_metric_data(
        Namespace='MyApplication',
        MetricData=metrics[:1000]  # Max 1000 per request
    )
```

### CloudWatch Agent

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CloudWatch Agent                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   The CloudWatch Agent collects metrics and logs from:                 â”‚
â”‚   â€¢ EC2 instances (Linux & Windows)                                    â”‚
â”‚   â€¢ On-premises servers                                                â”‚
â”‚   â€¢ Containers                                                         â”‚
â”‚                                                                         â”‚
â”‚   Metrics NOT available without agent:                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚   â€¢ Memory utilization                                                 â”‚
â”‚   â€¢ Disk space utilization                                             â”‚
â”‚   â€¢ Disk I/O                                                           â”‚
â”‚   â€¢ Network connections                                                â”‚
â”‚   â€¢ Process information                                                â”‚
â”‚                                                                         â”‚
â”‚   Configuration (amazon-cloudwatch-agent.json):                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  {                                                               â”‚  â”‚
â”‚   â”‚    "metrics": {                                                  â”‚  â”‚
â”‚   â”‚      "namespace": "MyApp/EC2",                                   â”‚  â”‚
â”‚   â”‚      "metrics_collected": {                                      â”‚  â”‚
â”‚   â”‚        "mem": {                                                  â”‚  â”‚
â”‚   â”‚          "measurement": ["mem_used_percent"]                     â”‚  â”‚
â”‚   â”‚        },                                                        â”‚  â”‚
â”‚   â”‚        "disk": {                                                 â”‚  â”‚
â”‚   â”‚          "measurement": ["disk_used_percent"],                   â”‚  â”‚
â”‚   â”‚          "resources": ["/", "/data"]                             â”‚  â”‚
â”‚   â”‚        }                                                         â”‚  â”‚
â”‚   â”‚      }                                                           â”‚  â”‚
â”‚   â”‚    },                                                            â”‚  â”‚
â”‚   â”‚    "logs": {                                                     â”‚  â”‚
â”‚   â”‚      "logs_collected": {                                         â”‚  â”‚
â”‚   â”‚        "files": {                                                â”‚  â”‚
â”‚   â”‚          "collect_list": [{                                      â”‚  â”‚
â”‚   â”‚            "file_path": "/var/log/myapp/*.log",                  â”‚  â”‚
â”‚   â”‚            "log_group_name": "myapp-logs",                       â”‚  â”‚
â”‚   â”‚            "log_stream_name": "{instance_id}"                    â”‚  â”‚
â”‚   â”‚          }]                                                      â”‚  â”‚
â”‚   â”‚        }                                                         â”‚  â”‚
â”‚   â”‚      }                                                           â”‚  â”‚
â”‚   â”‚    }                                                             â”‚  â”‚
â”‚   â”‚  }                                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CloudWatch Logs

### Log Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CloudWatch Logs Structure                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   LOG GROUP: /aws/lambda/order-service                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚   â€¢ Retention: 7 days to never expire                                  â”‚
â”‚   â€¢ Encryption: Optional KMS encryption                                â”‚
â”‚   â€¢ Metric Filters: Extract metrics from logs                          â”‚
â”‚   â€¢ Subscription Filters: Stream to Kinesis/Lambda                     â”‚
â”‚                                                                         â”‚
â”‚   â””â”€â”€ LOG STREAM: 2024/01/15/[$LATEST]abc123                          â”‚
â”‚       â””â”€â”€ LOG EVENT: {"timestamp": 1705312800000,                      â”‚
â”‚                       "message": "Order processed: ORD-123"}           â”‚
â”‚       â””â”€â”€ LOG EVENT: {"timestamp": 1705312801000,                      â”‚
â”‚                       "message": "Payment confirmed: PAY-456"}         â”‚
â”‚                                                                         â”‚
â”‚   â””â”€â”€ LOG STREAM: 2024/01/15/[$LATEST]def456                          â”‚
â”‚       â””â”€â”€ ...                                                          â”‚
â”‚                                                                         â”‚
â”‚   Pricing (us-east-1):                                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚   â€¢ Ingestion: $0.50 per GB                                            â”‚
â”‚   â€¢ Storage: $0.03 per GB/month                                        â”‚
â”‚   â€¢ Log Insights queries: $0.005 per GB scanned                        â”‚
â”‚   â€¢ Export to S3: Free (but S3 storage costs apply)                    â”‚
â”‚                                                                         â”‚
â”‚   Retention Settings:                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚   1 day, 3 days, 5 days, 1 week, 2 weeks, 1 month, 2 months,          â”‚
â”‚   3 months, 6 months, 1 year, 13 months, 18 months, 2 years,          â”‚
â”‚   3 years, 5 years, 6 years, 7 years, 8 years, 9 years, 10 years,     â”‚
â”‚   Never Expire                                                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Structured Logging Best Practices

```python
import json
import logging
from datetime import datetime
from typing import Any, Dict

class StructuredLogger:
    """JSON structured logger for CloudWatch Logs."""
    
    def __init__(self, service: str, environment: str):
        self.service = service
        self.environment = environment
        self.logger = logging.getLogger()
        self.logger.setLevel(logging.INFO)
    
    def _log(self, level: str, message: str, **extra):
        log_entry = {
            "timestamp": datetime.utcnow().isoformat() + "Z",
            "level": level,
            "service": self.service,
            "environment": self.environment,
            "message": message,
            **extra
        }
        print(json.dumps(log_entry))  # Lambda automatically captures stdout
    
    def info(self, message: str, **extra):
        self._log("INFO", message, **extra)
    
    def error(self, message: str, error: Exception = None, **extra):
        if error:
            extra["error_type"] = type(error).__name__
            extra["error_message"] = str(error)
        self._log("ERROR", message, **extra)
    
    def metric(self, name: str, value: float, unit: str = "Count", **extra):
        """Log a metric that can be extracted with metric filters."""
        self._log("METRIC", f"{name}={value}", 
                  metric_name=name, metric_value=value, metric_unit=unit, **extra)

# Usage
logger = StructuredLogger(service="order-service", environment="prod")

def process_order(order_id: str, user_id: str):
    logger.info("Processing order", order_id=order_id, user_id=user_id)
    
    try:
        # Business logic...
        logger.info("Order completed", 
                   order_id=order_id, 
                   duration_ms=150,
                   items_count=3)
        logger.metric("OrdersProcessed", 1, "Count", order_id=order_id)
        
    except Exception as e:
        logger.error("Order processing failed", 
                    error=e, 
                    order_id=order_id,
                    user_id=user_id)
        raise
```

### Log Insights Queries

```sql
-- Find all errors in the last hour
fields @timestamp, @message, @logStream
| filter @message like /ERROR/
| sort @timestamp desc
| limit 100

-- Parse JSON logs and aggregate by service
fields @timestamp, @message
| parse @message '{"service":"*","level":"*","message":"*"}' as service, level, msg
| filter level = "ERROR"
| stats count(*) as error_count by service
| sort error_count desc

-- Calculate Lambda p99 latency
fields @timestamp, @duration, @requestId
| filter @type = "REPORT"
| stats avg(@duration) as avg_ms,
        pct(@duration, 50) as p50_ms,
        pct(@duration, 95) as p95_ms,
        pct(@duration, 99) as p99_ms
  by bin(1h)

-- Find slow API requests
fields @timestamp, @message
| parse @message '"duration_ms":*,' as duration
| filter duration > 1000
| sort duration desc
| limit 50

-- Error rate calculation
fields @timestamp, @message
| filter @message like /level/
| parse @message '"level":"*"' as level
| stats count(*) as total,
        sum(level = "ERROR") as errors
  by bin(5m)
| sort @timestamp desc

-- Top contributors to log volume
fields @logStream, @message
| stats count(*) as log_count by @logStream
| sort log_count desc
| limit 20

-- Correlation by request ID
fields @timestamp, @message, @logStream
| parse @message '"request_id":"*"' as request_id
| filter request_id = "abc-123-def-456"
| sort @timestamp asc
```

### Metric Filters

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Metric Filters                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Extract metrics from logs automatically:                              â”‚
â”‚                                                                         â”‚
â”‚   Filter Pattern               â”‚ Metric Created                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚   ERROR                        â”‚ Count of ERROR occurrences            â”‚
â”‚   [timestamp, level=ERROR, ...] â”‚ Count of structured errors           â”‚
â”‚   "status": 500                â”‚ Count of 500 errors                   â”‚
â”‚   { $.latency > 1000 }         â”‚ Count of slow requests (JSON)        â”‚
â”‚                                                                         â”‚
â”‚   Example: Track application errors                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Filter Pattern: { $.level = "ERROR" }                          â”‚  â”‚
â”‚   â”‚  Metric Name: ApplicationErrors                                  â”‚  â”‚
â”‚   â”‚  Metric Namespace: MyApp                                        â”‚  â”‚
â”‚   â”‚  Metric Value: 1                                                 â”‚  â”‚
â”‚   â”‚  Default Value: 0                                                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   Example: Extract latency from JSON logs                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Filter Pattern: { $.type = "REQUEST" }                         â”‚  â”‚
â”‚   â”‚  Metric Name: RequestLatency                                     â”‚  â”‚
â”‚   â”‚  Metric Namespace: MyApp                                        â”‚  â”‚
â”‚   â”‚  Metric Value: $.latency                                         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CloudWatch Alarms

### Alarm Types and States

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CloudWatch Alarms                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Alarm States:                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚    OK     â”‚â”€â”€â”€â”€â–ºâ”‚   ALARM   â”‚â”€â”€â”€â”€â–ºâ”‚ INSUFFICIENT    â”‚              â”‚
â”‚   â”‚  (green)  â”‚â—„â”€â”€â”€â”€â”‚   (red)   â”‚â—„â”€â”€â”€â”€â”‚     DATA        â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                         â”‚
â”‚   Alarm Components:                                                     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚   â€¢ Metric: What to monitor (CPUUtilization, custom metric)           â”‚
â”‚   â€¢ Statistic: How to aggregate (Average, Sum, Max, p99)              â”‚
â”‚   â€¢ Period: Evaluation period (60s, 300s, etc.)                        â”‚
â”‚   â€¢ Evaluation Periods: How many periods before alarm                  â”‚
â”‚   â€¢ Threshold: Value that triggers alarm                               â”‚
â”‚   â€¢ Comparison: GreaterThan, LessThan, etc.                           â”‚
â”‚                                                                         â”‚
â”‚   Example Configuration:                                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚   Metric: CPUUtilization                                               â”‚
â”‚   Statistic: Average                                                   â”‚
â”‚   Period: 300 seconds (5 min)                                          â”‚
â”‚   Evaluation Periods: 3                                                â”‚
â”‚   Threshold: 80%                                                       â”‚
â”‚   â†’ Alarm triggers when CPU > 80% for 3 consecutive 5-min periods     â”‚
â”‚                                                                         â”‚
â”‚   Alarm Actions:                                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚   â€¢ SNS Topic â†’ Email, SMS, Lambda                                     â”‚
â”‚   â€¢ Auto Scaling â†’ Scale up/down                                       â”‚
â”‚   â€¢ EC2 Actions â†’ Stop, terminate, reboot, recover                     â”‚
â”‚   â€¢ Systems Manager â†’ Run automation documents                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Essential Alarms (Terraform)

```hcl
# High CPU Alarm with Auto Scaling
resource "aws_cloudwatch_metric_alarm" "high_cpu" {
  alarm_name          = "${var.app_name}-high-cpu"
  comparison_operator = "GreaterThanThreshold"
  evaluation_periods  = 3
  metric_name         = "CPUUtilization"
  namespace           = "AWS/EC2"
  period              = 300
  statistic           = "Average"
  threshold           = 80
  alarm_description   = "CPU exceeds 80% for 15 minutes"
  
  dimensions = {
    AutoScalingGroupName = aws_autoscaling_group.web.name
  }
  
  alarm_actions = [
    aws_sns_topic.alerts.arn,
    aws_autoscaling_policy.scale_up.arn
  ]
  
  ok_actions = [aws_sns_topic.alerts.arn]
}

# Lambda Error Rate (Metric Math)
resource "aws_cloudwatch_metric_alarm" "lambda_error_rate" {
  alarm_name          = "${var.app_name}-lambda-errors"
  comparison_operator = "GreaterThanThreshold"
  evaluation_periods  = 2
  threshold           = 5  # 5% error rate
  
  metric_query {
    id          = "error_rate"
    expression  = "errors / invocations * 100"
    label       = "Error Rate %"
    return_data = true
  }
  
  metric_query {
    id = "errors"
    metric {
      metric_name = "Errors"
      namespace   = "AWS/Lambda"
      period      = 300
      stat        = "Sum"
      dimensions = {
        FunctionName = aws_lambda_function.api.function_name
      }
    }
  }
  
  metric_query {
    id = "invocations"
    metric {
      metric_name = "Invocations"
      namespace   = "AWS/Lambda"
      period      = 300
      stat        = "Sum"
      dimensions = {
        FunctionName = aws_lambda_function.api.function_name
      }
    }
  }
  
  alarm_actions = [aws_sns_topic.alerts.arn]
}

# Anomaly Detection Alarm
resource "aws_cloudwatch_metric_alarm" "traffic_anomaly" {
  alarm_name          = "${var.app_name}-traffic-anomaly"
  comparison_operator = "LessThanLowerOrGreaterThanUpperThreshold"
  evaluation_periods  = 2
  
  threshold_metric_id = "ad1"
  
  metric_query {
    id          = "m1"
    return_data = true
    metric {
      metric_name = "RequestCount"
      namespace   = "AWS/ApplicationELB"
      period      = 300
      stat        = "Sum"
      dimensions = {
        LoadBalancer = aws_lb.main.arn_suffix
      }
    }
  }
  
  metric_query {
    id          = "ad1"
    expression  = "ANOMALY_DETECTION_BAND(m1, 2)"
    label       = "Traffic Anomaly Band"
    return_data = true
  }
  
  alarm_actions = [aws_sns_topic.alerts.arn]
}

# Composite Alarm (multiple conditions)
resource "aws_cloudwatch_composite_alarm" "critical" {
  alarm_name = "${var.app_name}-critical"
  
  alarm_rule = join(" OR ", [
    "ALARM(${aws_cloudwatch_metric_alarm.high_cpu.alarm_name})",
    "ALARM(${aws_cloudwatch_metric_alarm.lambda_error_rate.alarm_name})",
  ])
  
  alarm_actions = [aws_sns_topic.pagerduty.arn]
}
```

---

## CloudWatch Dashboards

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Dashboard Design                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  MY APPLICATION DASHBOARD                           ğŸ“Š ğŸ”— âš™ï¸   â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚                                                               â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
â”‚   â”‚  â”‚ ğŸŸ¢ Healthy Hosts: 4 â”‚  â”‚ ğŸ“ˆ Request Rate                 â”‚â”‚    â”‚
â”‚   â”‚  â”‚ ğŸ”´ Errors: 0.1%     â”‚  â”‚ [Line graph of requests/min]   â”‚â”‚    â”‚
â”‚   â”‚  â”‚ â±ï¸ P99 Latency: 45msâ”‚  â”‚                                 â”‚â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
â”‚   â”‚                                                               â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚ ğŸ“Š API Response Times by Endpoint                      â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ â”‚ /orders â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 45ms                      â”‚ â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ â”‚ /users  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 25ms                              â”‚ â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ â”‚ /products â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 55ms                  â”‚ â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                                                               â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
â”‚   â”‚  â”‚ Lambda Invocations  â”‚  â”‚ DynamoDB Consumed Capacity      â”‚â”‚    â”‚
â”‚   â”‚  â”‚ [Stacked area chart]â”‚  â”‚ [RCU/WCU over time]             â”‚â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
â”‚   â”‚                                                               â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚   â”‚  â”‚ ğŸ“ Recent Errors (Log Widget)                          â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ 10:23:45 ERROR Payment failed: insufficient funds      â”‚  â”‚    â”‚
â”‚   â”‚  â”‚ 10:22:30 ERROR Timeout connecting to external API      â”‚  â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚   â”‚                                                               â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚   Widget Types:                                                         â”‚
â”‚   â€¢ Line, Stacked area, Number, Gauge, Bar, Pie                        â”‚
â”‚   â€¢ Text (Markdown), Log (Log Insights), Alarm status                  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dashboard as Code

```python
import json

# CloudWatch Dashboard JSON definition
dashboard_body = {
    "widgets": [
        # Key Metrics Row
        {
            "type": "metric",
            "x": 0, "y": 0, "width": 6, "height": 6,
            "properties": {
                "title": "Request Count",
                "metrics": [
                    ["AWS/ApplicationELB", "RequestCount", "LoadBalancer", "app/my-alb/1234"]
                ],
                "period": 60,
                "stat": "Sum",
                "region": "us-east-1"
            }
        },
        {
            "type": "metric",
            "x": 6, "y": 0, "width": 6, "height": 6,
            "properties": {
                "title": "Response Time (p99)",
                "metrics": [
                    ["AWS/ApplicationELB", "TargetResponseTime", "LoadBalancer", "app/my-alb/1234"]
                ],
                "period": 60,
                "stat": "p99",
                "region": "us-east-1"
            }
        },
        # Lambda Metrics
        {
            "type": "metric",
            "x": 0, "y": 6, "width": 12, "height": 6,
            "properties": {
                "title": "Lambda Performance",
                "metrics": [
                    ["AWS/Lambda", "Duration", "FunctionName", "my-function", {"stat": "Average"}],
                    [".", ".", ".", ".", {"stat": "p95"}],
                    [".", ".", ".", ".", {"stat": "p99"}]
                ],
                "period": 60,
                "region": "us-east-1"
            }
        },
        # Alarm Status Widget
        {
            "type": "alarm",
            "x": 12, "y": 0, "width": 6, "height": 6,
            "properties": {
                "title": "Alarm Status",
                "alarms": [
                    "arn:aws:cloudwatch:us-east-1:123456789012:alarm:HighCPU",
                    "arn:aws:cloudwatch:us-east-1:123456789012:alarm:ErrorRate"
                ]
            }
        },
        # Log Widget
        {
            "type": "log",
            "x": 0, "y": 12, "width": 24, "height": 6,
            "properties": {
                "title": "Recent Errors",
                "query": "SOURCE '/aws/lambda/my-function' | filter @message like /ERROR/ | sort @timestamp desc | limit 20",
                "region": "us-east-1"
            }
        }
    ]
}

# Create/update dashboard
import boto3
cloudwatch = boto3.client('cloudwatch')
cloudwatch.put_dashboard(
    DashboardName='MyApplicationDashboard',
    DashboardBody=json.dumps(dashboard_body)
)
```

---

## CloudWatch Synthetics

Canary tests that monitor your endpoints 24/7.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CloudWatch Synthetics                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Canary Types:                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚   â€¢ Heartbeat: Simple availability check                               â”‚
â”‚   â€¢ API: REST API endpoint testing                                     â”‚
â”‚   â€¢ Broken Link: Check for broken links                               â”‚
â”‚   â€¢ Visual: Screenshot comparison                                      â”‚
â”‚   â€¢ GUI Workflow: Multi-step browser tests                             â”‚
â”‚                                                                         â”‚
â”‚   Features:                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚   â€¢ Runs on a schedule (1 min to 1 hour)                               â”‚
â”‚   â€¢ Captures screenshots and HAR files                                 â”‚
â”‚   â€¢ Integrates with CloudWatch Alarms                                  â”‚
â”‚   â€¢ Uses Puppeteer or Selenium                                         â”‚
â”‚                                                                         â”‚
â”‚   Example: API Canary Script (Node.js)                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  const synthetics = require('Synthetics');                      â”‚  â”‚
â”‚   â”‚  const log = require('SyntheticsLogger');                       â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚  const apiCanary = async function() {                           â”‚  â”‚
â”‚   â”‚    const page = await synthetics.getPage();                     â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚    // Test API endpoint                                          â”‚  â”‚
â”‚   â”‚    const response = await page.goto('https://api.example.com'); â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚    if (response.status() !== 200) {                             â”‚  â”‚
â”‚   â”‚      throw new Error(`Expected 200, got ${response.status()}`); â”‚  â”‚
â”‚   â”‚    }                                                             â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚    log.info('API check passed');                                 â”‚  â”‚
â”‚   â”‚  };                                                              â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚  exports.handler = async () => {                                â”‚  â”‚
â”‚   â”‚    return await apiCanary();                                     â”‚  â”‚
â”‚   â”‚  };                                                              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   Pricing: $0.0012 per canary run                                      â”‚
â”‚   100 runs/day Ã— 30 days = $3.60/month per canary                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CloudWatch Contributor Insights

Identify top contributors to high cardinality data.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Contributor Insights                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Use Cases:                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚   â€¢ Find top IPs making requests                                       â”‚
â”‚   â€¢ Identify users causing errors                                      â”‚
â”‚   â€¢ Detect DDoS patterns                                               â”‚
â”‚   â€¢ Find hottest DynamoDB partition keys                               â”‚
â”‚                                                                         â”‚
â”‚   Example: Top Error-Producing API Endpoints                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Rank â”‚ Endpoint          â”‚ Error Count â”‚ % of Total            â”‚  â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚
â”‚   â”‚  1    â”‚ /api/v1/checkout  â”‚ 1,234       â”‚ 45%                   â”‚  â”‚
â”‚   â”‚  2    â”‚ /api/v1/payment   â”‚ 567         â”‚ 21%                   â”‚  â”‚
â”‚   â”‚  3    â”‚ /api/v1/search    â”‚ 234         â”‚ 9%                    â”‚  â”‚
â”‚   â”‚  4    â”‚ /api/v1/users     â”‚ 123         â”‚ 5%                    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚   Rule Definition:                                                      â”‚
â”‚   {                                                                     â”‚
â”‚     "Schema": {                                                         â”‚
â”‚       "Name": "CloudWatchLogRule",                                     â”‚
â”‚       "Version": 1                                                      â”‚
â”‚     },                                                                  â”‚
â”‚     "LogGroupNames": ["/aws/lambda/my-api"],                           â”‚
â”‚     "LogFormat": "JSON",                                               â”‚
â”‚     "Fields": {                                                         â”‚
â”‚       "endpoint": "$.path",                                            â”‚
â”‚       "status": "$.status_code"                                        â”‚
â”‚     },                                                                  â”‚
â”‚     "Contribution": {                                                   â”‚
â”‚       "Keys": ["endpoint"],                                            â”‚
â”‚       "Filters": [{"Match": "$.status_code", "GreaterThan": 499}]     â”‚
â”‚     }                                                                   â”‚
â”‚   }                                                                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Best Practices

<CardGroup cols={2}>
  <Card title="Set Retention Policies" icon="clock">
    Configure log retention to balance cost and compliance needs
  </Card>
  <Card title="Use Structured Logging" icon="code">
    JSON format enables powerful Log Insights queries
  </Card>
  <Card title="Alert on Symptoms" icon="bell">
    Focus on user-facing metrics, not just infrastructure
  </Card>
  <Card title="Tune Alarm Thresholds" icon="sliders">
    Avoid alert fatigue with well-calibrated thresholds
  </Card>
  <Card title="Dashboard Hierarchy" icon="sitemap">
    Executive â†’ Service â†’ Debug dashboards
  </Card>
  <Card title="Cost Awareness" icon="dollar-sign">
    Monitor CloudWatch costsâ€”they can surprise you
  </Card>
</CardGroup>

### Cost Optimization

```python
cost_tips = {
    "logs": [
        "Set appropriate retention (default: never expire)",
        "Export to S3 for long-term storage (cheaper)",
        "Use metric filters instead of querying raw logs",
        "Filter at source (log level, sampling)",
    ],
    "metrics": [
        "Minimize custom metric dimensions",
        "Use EMF for metrics-from-logs (free publishing)",
        "Consider high-res metrics only where needed",
        "Delete unused custom metrics",
    ],
    "alarms": [
        "Use composite alarms to reduce noise",
        "Consolidate similar alarms",
        "Avoid very short periods on high-cardinality metrics",
    ],
    "dashboards": [
        "Share dashboards instead of duplicating",
        "Use automatic refresh wisely",
    ]
}

# Cost estimation
monthly_costs = {
    "custom_metrics": "10,000 metrics Ã— $0.30 = $3,000",
    "log_ingestion": "100 GB Ã— $0.50 = $50",
    "log_storage": "1 TB Ã— $0.03 = $30",
    "log_insights": "500 GB scanned Ã— $0.005 = $2.50",
    "alarms": "100 alarms Ã— $0.10 = $10",
    "dashboards": "First 3 free, then $3/month each",
}
```

---

## ğŸ¯ Interview Questions

<AccordionGroup>
  <Accordion title="Q1: CloudWatch Logs vs X-Ray vs CloudTrail?">
    **CloudWatch Logs:**
    - Application and system logs
    - What your code outputs
    - Debugging, troubleshooting
    
    **X-Ray:**
    - Distributed tracing
    - Request flow across services
    - Performance analysis
    
    **CloudTrail:**
    - AWS API call history
    - Who did what, when
    - Security auditing
  </Accordion>
  
  <Accordion title="Q2: How to reduce CloudWatch Logs costs?">
    1. **Set retention policies** (don't keep forever)
    2. **Export to S3** for long-term (use lifecycle rules)
    3. **Filter at source** (log levels, sampling)
    4. **Use metric filters** instead of Log Insights for common queries
    5. **Compress logs** before ingestion
    6. **Use Contributor Insights rules** for ongoing analysis
  </Accordion>
  
  <Accordion title="Q3: What's the difference between metric alarms and composite alarms?">
    **Metric Alarms:**
    - Monitor single metric
    - Simple threshold or anomaly detection
    - One condition
    
    **Composite Alarms:**
    - Combine multiple alarms with AND/OR/NOT
    - Reduce alert noise
    - Complex conditions like: "High CPU AND High Memory"
    - Better for on-call (fewer, more actionable alerts)
  </Accordion>
  
  <Accordion title="Q4: EC2 memory not showing in CloudWatch?">
    **Why:** EC2 basic monitoring doesn't include memoryâ€”it's inside the OS, not visible to hypervisor.
    
    **Solution:** Install CloudWatch Agent
    ```bash
    # Install agent
    sudo yum install amazon-cloudwatch-agent
    
    # Configure
    sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-config-wizard
    
    # Start
    sudo systemctl start amazon-cloudwatch-agent
    ```
  </Accordion>
  
  <Accordion title="Q5: How to monitor Lambda cold starts?">
    **Built-in:** Lambda doesn't have a direct cold start metric.
    
    **Solutions:**
    1. **Init Duration** in REPORT logs
    ```sql
    fields @timestamp, @initDuration
    | filter @type = "REPORT" and ispresent(@initDuration)
    | stats avg(@initDuration), max(@initDuration), count(*)
    ```
    
    2. **Custom metric** from code (measure init time)
    
    3. **X-Ray** shows initialization segment
    
    4. **Lambda Insights** (enhanced monitoring)
  </Accordion>
</AccordionGroup>

---

## ğŸ§ª Hands-On Lab

<Steps>
  <Step title="Set Up Structured Logging">
    Implement JSON logging in a Lambda function
  </Step>
  
  <Step title="Create Metric Filter">
    Extract error count metric from logs
  </Step>
  
  <Step title="Build Dashboard">
    Create operational dashboard with key metrics
  </Step>
  
  <Step title="Configure Alarms">
    Set up metric and composite alarms with SNS notification
  </Step>
  
  <Step title="Create Canary">
    Set up synthetic monitoring for your API endpoint
  </Step>
</Steps>

---

## Next Module

<Card title="AWS X-Ray" icon="microscope" href="/aws/xray">
  Master distributed tracing with AWS X-Ray
</Card>
