---
title: "High Availability & Disaster Recovery"
description: "Master HA/DR strategies, RPO/RTO, and multi-region architectures"
icon: "life-ring"
---

# High Availability & Disaster Recovery

Design systems that survive failures and disasters. Learn to achieve 99.99% availability.

![Azure HA/DR Patterns](/images/azure/13-ha-dr-patterns.svg)

---

## 1. Availability SLAs

<Tabs>
  <Tab title="SLA Levels">
    ```
    99%     = 7.2 hours downtime/month
    99.9%   = 43.2 minutes downtime/month
    99.95%  = 21.6 minutes downtime/month
    99.99%  = 4.3 minutes downtime/month
    99.999% = 26 seconds downtime/month
    ```
  </Tab>

  <Tab title="Azure Service SLAs">
    | Service | Configuration | SLA |
    |---------|--------------|-----|
    | **VM** | Single instance (Premium SSD) | 99.9% |
    | **VM** | 2+ in Availability Set | 99.95% |
    | **VM** | 2+ across Availability Zones | 99.99% |
    | **App Service** | Standard tier | 99.95% |
    | **Azure SQL** | General Purpose | 99.99% |
    | **Azure SQL** | Business Critical (zone-redundant) | 99.995% |
    | **Cosmos DB** | Single region | 99.99% |
    | **Cosmos DB** | Multi-region | 99.999% |
  </Tab>
</Tabs>

---

## 2. RPO & RTO

> [!WARNING]
> **Gotcha: RPO vs RTO**
> A common interview trap.
> **RPO (Point)** = Data Loss (How far back do we go?)
> **RTO (Time)** = Downtime (How long until we are back online?)
> You can have low RPO (0 data loss) but high RTO (took 4 hours to restart).

> [!TIP]
> **Jargon Alert: Split Brain**
> A disaster scenario where two databases both think they are "Primary" and accept writes at the same time, corrupting data. Always use a "Witness" or "Quorum" to preventing this in active-active architectures.

**RPO (Recovery Point Objective)**: How much data loss is acceptable?
**RTO (Recovery Time Objective)**: How long to recover?

<div className="flex justify-center my-4">
  <div className="w-full max-w-4xl">
    ```mermaid
    graph LR
        A[Normal Operation] --> B[Disaster Occurs]
        B --> C[Last Backup<br/>RPO]
        C --> D[Recovery Process<br/>RTO]
        D --> E[Service Restored]

        style B fill:#FF6B6B
        style E fill:#51CF66
    ```
  </div>
</div>

### Example Scenarios

```
Scenario 1: E-commerce Site
RPO: 5 minutes (transactional data)
RTO: 15 minutes (revenue impact)
Solution: Auto-failover groups, zone-redundant services

Scenario 2: Internal Analytics
RPO: 24 hours (reports can be delayed)
RTO: 4 hours (not business-critical)
Solution: Daily backups, manual recovery

Scenario 3: Banking System
RPO: 0 seconds (no data loss acceptable)
RTO: < 1 minute (critical business)
Solution: Synchronous replication, active-active
```

---

## 3. High Availability Patterns

<AccordionGroup>
  <Accordion title="1. Active-Passive" icon="power-off">
    ```
    Primary Region (Active)
      - Handles all traffic
      - Replicates to secondary

    Secondary Region (Passive)
      - Standby mode
      - Activated on primary failure

    Pros: Simple, cost-effective
    Cons: Unused capacity, manual failover
    ```
  </Accordion>

  <Accordion title="2. Active-Active" icon="bolt">
    ```
    Region 1 (Active)
      - Handles 50% traffic

    Region 2 (Active)
      - Handles 50% traffic

    Both regions process requests simultaneously

    Pros: Maximum availability, no wasted capacity
    Cons: Complex (data conflicts), expensive
    ```
  </Accordion>

  <Accordion title="3. Multi-Region with Traffic Manager" icon="globe">
    ```
    Azure Front Door / Traffic Manager
      ├── Primary: East US (priority 1)
      ├── Secondary: West Europe (priority 2)
      └── Tertiary: Southeast Asia (priority 3)

    Automatic failover based on health probes
    ```
  </Accordion>
</AccordionGroup>

---

## 4. Disaster Recovery Architecture

### Example: E-Commerce Platform

```
Primary Region: East US
- App Service (zone-redundant)
- Azure SQL (zone-redundant)
- Redis Cache (zone-redundant)
- Front Door (global)

Secondary Region: West US (Passive)
- App Service (scaled to minimum)
- Azure SQL (geo-replica, read-only)
- Redis Cache (geo-replication)

Failover Process:
1. Front Door detects primary unhealthy
2. Routes traffic to secondary (automatic)
3. Promote SQL replica to primary
4. Scale up App Service instances
5. Total failover time: < 5 minutes
```

---

## 5. Backup Strategies

<Tabs>
  <Tab title="VMs">
    ```bash
    # Enable Azure Backup
    az backup protection enable-for-vm \
      --resource-group rg-prod \
      --vault-name RecoveryServicesVault \
      --vm vm-web-01 \
      --policy-name DefaultPolicy

    # Retention:
    # - Daily: 7 days
    # - Weekly: 4 weeks
    # - Monthly: 12 months
    # - Yearly: 10 years
    ```
  </Tab>

  <Tab title="Databases">
    ```
    Azure SQL:
    - Automatic backups (7-35 days)
    - Point-in-time restore
    - Long-term retention (up to 10 years)
    - Geo-restore (to any region)

    Cosmos DB:
    - Continuous backup (30 days)
    - Point-in-time restore
    - Restore to same or different account
    ```
  </Tab>

  <Tab title="Storage">
    ```
    Blob Storage:
    - Soft delete (7-365 days)
    - Blob versioning
    - Snapshots
    - GRS (geo-redundant storage)

    Lifecycle management:
    - Hot → Cool → Archive
    - Automated retention policies
    ```
  </Tab>
</Tabs>

---

## 6. Testing DR Plan

**Disaster Recovery Drill Checklist**:

```
✅ Document all runbooks
✅ Test failover quarterly
✅ Measure actual RTO/RPO
✅ Update contact lists
✅ Test backup restores
✅ Verify monitoring alerts
✅ Review and update documentation
✅ Conduct post-drill review
```

---

---

## 7. Interview Questions

### Beginner Level

<AccordionGroup>
  <Accordion title="Q1: What is the difference between Availability and Durability?">
    **Answer**:
    - **Availability**: Uptime. Can I access the service right now? (e.g., SLA 99.9%).
    - **Durability**: Data integrity. Is my data safe from loss? (e.g., 11 nines 99.999999999% for Blob Storage).
    *You can have high availability but lose data (corruption), or high durability but be offline.*
  </Accordion>

  <Accordion title="Q2: What is an Availability Zone?">
    **Answer**:
    A physically separate datacenter within the same Azure Context (Region). It has independent power, cooling, and networking.
    Protects against datacenter-level failures (fire, power cut).
  </Accordion>
</AccordionGroup>

### Intermediate Level

<AccordionGroup>
  <Accordion title="Q3: Explain RPO and RTO in simple terms">
    **Answer**:
    - **RPO (Recovery Point Objective)**: "How much data can we lose?" (Time since last backup).
    - **RTO (Recovery Time Objective)**: "How long can we be down?" (Time to restore service).
  </Accordion>

  <Accordion title="Q4: Active-Passive vs Active-Active?">
    **Answer**:
    - **Active-Passive**: One region handles traffic. Secondary is standby. Cheaper, slower failover (RTO > 0).
    - **Active-Active**: Both regions handle traffic. Complex data sync. Expensive. zero downtime failover (RTO ≈ 0).
  </Accordion>
</AccordionGroup>

### Advanced Level

<AccordionGroup>
  <Accordion title="Q5: How do you achieve 99.99% SLA not offered by a single service?">
    **Answer**:
    By using **Composite SLAs**.
    If you have two regions, each with 99.9% availability, the probability of *both* failing simultaneously is $0.1\% \times 0.1\% = 0.01\%$.
    Total Availability = $100\% - 0.01\% = 99.99\%$.
    *Redundancy increases availability.*
  </Accordion>
</AccordionGroup>

---

## 8. Key Takeaways

<CardGroup cols={2}>
  <Card title="SLA Mathematics" icon="calculator">
    Understand how SLAs compound. Dependencies reduce availability; Redundancy increases it.
  </Card>
  <Card title="Zones vs Regions" icon="map">
    Use **Zones** for synchronous HA (High Availability). Use **Regions** for asynchronous DR (Disaster Recovery).
  </Card>
  <Card title="Data Gravity" icon="database">
    Compute is stateless and easy to move. Data is heavy and hard to sync. Focus DR efforts on data replication.
  </Card>
  <Card title="Testing" icon="vial">
    A backup is useless if you can't restore it. A DR plan is a hypothesis until tested.
  </Card>
  <Card title="Business Alignment" icon="briefcase">
    RPO/RTO are business decisions, not technical ones. They dictate the cost of the designated solution.
  </Card>
</CardGroup>

---

## Next Steps

<Card title="Continue to Chapter 14" icon="arrow-right" href="/courses/azure-cloud-engineering/14-architecture-patterns">
  Master real-world Azure architecture patterns and design principles
</Card>
