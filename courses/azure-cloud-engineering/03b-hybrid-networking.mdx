---
title: "03b. Hybrid & Enterprise"
description: "Master ExpressRoute, VPN, Virtual WAN, and Routing"
icon: "globe"
---

# Hybrid Networking & Enterprise Connectivity

For most enterprises, the cloud isn't an islandâ€”it's an extension of their on-premises datacenter.

---

## 1. Connecting to On-Premises

### VPN Gateway
Encrypted traffic over the public internet.

**Types**:
1.  **Point-to-Site (P2S)**: For individual developers working remotely. Connects your laptop to Azure.
2.  **Site-to-Site (S2S)**: Connects an entire office to Azure. Uses an IPsec/IKE VPN tunnel.

**SKU Selection**:
| SKU | Bandwidth | Tunnels | Zone Redundant? | Use Case |
|-----|-----------|---------|-----------------|----------|
| **Basic** | 100 Mbps | 10 | No | Dev/Test only (No BGP) |
| **VpnGw1** | 650 Mbps | 30 | No | Production Entry |
| **VpnGw2AZ** | 1 Gbps | 30 | **Yes** | Mission Critical |
| **VpnGw5AZ** | 10 Gbps | 100 | **Yes** | High scale |

### ExpressRoute
Private, dedicated connection. Traffic **never** touches the public internet.

**Benefits**:
- **Security**: Private link.
- **Reliability**: SLA up to 99.95% (without internet fluctuations).
- **Speed**: Up to 100 Gbps (Direct).

> [!WARNING]
> **Gotcha: ExpressRoute Cost**
> You pay for the **Circuit** (monthly flat fee) AND the **Gateway** (hourly fee) AND **Outbound Data** (unless you have an Unlimited plan). It is significantly more expensive than VPN.

![Hybrid Connectivity](/images/azure/03b-hybrid-connectivity.svg)

---

## 2. Azure Virtual WAN (vWAN)

Virtual WAN is "Hub-and-Spoke as a Service". Instead of managing your own Hub VNet with complex peering and routing tables, Microsoft manages the Hub for you.

**Capabilities**:
- Automated Site-to-Site VPN
- Automated P2S User VPN
- ExpressRoute integration
- Transit Routing (Spoke-to-Spoke, Spoke-to-Branch)
- Integrated Azure Firewall

> [!TIP]
> **Jargon Alert: Transit Routing**
> In standard peering, Spoke A cannot talk to Spoke B. In Virtual WAN, **all spokes can talk to everything** (if you allow it) because the vHub acts as a super-router.

![Virtual WAN Architecture](/images/azure/03b-virtual-wan.svg)

---

## 3. User Defined Routes (UDR)

By default, Azure knows how to route traffic between subnets and to the internet. Sometimes, you want to force traffic to go somewhere else (like a Firewall).

**Routing Table Priority**:
1.  **User Defined Route (UDR)**
2.  **BGP Route** (from ExpressRoute/VPN)
3.  **System Route** (Default)

**Common UDR Scenario**:
*Force all internet traffic through Azure Firewall.*

1.  Create Route Table.
2.  Add Rule: `0.0.0.0/0` -> `Virtual Appliance` -> `10.0.1.4` (Firewall IP).
3.  Associate Route Table with your Subnets.

> [!WARNING]
> **Gotcha: Asymmetric Routing**
> If your request goes out via Azure Firewall but the return traffic comes back via ExpressRoute bypass, the firewall will drop the packet (it didn't see the SYN). Ensure traffic flows symmetrically!

---

## 4. Azure Bastion

The secure way to RDP/SSH into your VMs.

**Why use it?**
- **No Public IPs** needed on your VMs.
- **No TCP 3389/22** open to the internet.
- **TLS 443**: Access via your web browser (Portal).

**Requirements**:
- Dedicated subnet named `AzureBastionSubnet`.
- Subnet size must be `/27` or larger.
- Public IP (Standard SKU) for the Bastion host itself.

> [!NOTE]
> **Deep Dive: Bastion Native Client**
> You can now use your local native SSH/RDP client (terminal/mstsc) to tunnel through Bastion using the Azure CLI:
> `az network bastion tunnel`
