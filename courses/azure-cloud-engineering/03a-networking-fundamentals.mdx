---
title: "03a. Networking Fundamentals"
description: "Master Subnets, CIDR, Network Security Groups, and Private Links"
icon: "network-wired"
---

# Advanced Networking Fundamentals

Networking is the nervous system of the cloud. In this three-part deep dive, we will move beyond the basics to master the complex networking scenarios you'll face in enterprise environments.

![Azure Networking Fundamentals](/images/azure/03a-networking-fundamentals.svg)

---

## 1. IP Addressing & Subnetting Strategy

Correctly planning your IP address space is the single most critical step. You cannot easily change a VNet's address space after peering it.

### CIDR Deep Dive
Azure uses Classless Inter-Domain Routing (CIDR) notation.

> [!TIP]
> **Jargon Alert: CIDR Block**
> A way to state "IP Address + Network Size".
> `10.0.0.0/16` means "Start at 10.0.0.0, and the first 16 bits are fixed." The remaining 16 bits are for your devices.

### Subnet Calculation Cheat Sheet

| CIDR | Total IPs | Usable IPs (Azure) | Use Case |
|------|-----------|--------------------|----------|
| `/16` | 65,536 | 65,531 | **VNet Address Space** (Standard enterprise size) |
| `/20` | 4,096 | 4,091 | **Large Subnet** (AKS Clusters) |
| `/24` | 256 | 251 | **Standard Subnet** (Web tier, App tier) |
| `/26` | 64 | 59 | **Gateway Subnet** (VPN/ExpressRoute) |
| `/27` | 32 | 27 | **Azure Bastion** (Required size) |
| `/29` | 8 | 3 | **Tiny Subnet** (Azure Firewall management) |

> [!WARNING]
> **Gotcha: Azure's 5 Reserved IPs**
> In every subnet, Azure reserves 5 IP addresses:
> 1. `x.x.x.0`: Network address
> 2. `x.x.x.1`: Default gateway
> 3. `x.x.x.2`: Azure DNS mapping
> 4. `x.x.x.3`: Azure DNS mapping
> 5. `x.x.x.255`: Broadcast address (Azure doesn't support broadcast)
>
> **Implication**: A `/29` subnet only has 3 usable IPs!

---

## 2. Network Security Groups (NSG) vs Application Security Groups (ASG)

### Network Security Groups (NSG)
The firewall for your subnet or network interface (NIC). It contains a list of Allow/Deny rules.

**Key Rules**:
- **Priority**: Lower number = Higher priority (100 overrides 200).
- **5-Tuple**: Source IP, Source Port, Dest IP, Dest Port, Protocol.
- **Stateful**: If you allow traffic IN, the response OUT is automatically allowed.

### Application Security Groups (ASG)
ASGs allow you to group VMs by their *function* rather than their IP address.

**The Problem**:
You have 10 web servers. You want to allow Port 80 to all of them.
*Traditional Way*: Create an NSG rule for each IP, or put them all in one tidy subnet.
*ASG Way*: Tag the NICs with "WebASG". Create ONE NSG rule: "Allow Internet to WebASG".

> [!NOTE]
> **Deep Dive: When to use ASGs?**
> Use ASGs when you have multiple fast-changing workloads in a single subnet and need granular micro-segmentation. If you just have tiered subnets (Web, App, DB), standard subnet-level NSGs are usually cleaner.

![NSG vs ASG Diagram](/images/azure/03a-nsg-vs-asg.svg)

---

## 3. Secure Access: Service Endpoints vs Private Link

This is a favorite interview topic. Both secure access to PaaS (SQL, Storage), but differently.

| Feature | Service Endpoints | Private Link (Private Endpoint) |
|---------|-------------------|---------------------------------|
| **Traffic Path** | Optimized route over Azure backbone | Private IP inside your VNet |
| **PaaS IP** | Public IP | **Private IP** (e.g., 10.0.1.5) |
| **On-Prem Access** | No (unless forced tunneling) | **Yes** (via VPN/ExpressRoute) |
| **Data Exfiltration**| Harder to block | **protected** (maps to specific instance) |
| **Cost** | Free | $/hour + Data processing charge |

### Service Endpoints
"leaves" your VNet to talk to the Public PaaS resource, but Azure recognizes the traffic is coming from your subnet.

### Private Endpoint (Private Link)
"Brings" the PaaS resource *into* your VNet. It gets a real private IP address from your subnet.

> [!IMPORTANT]
> **Recommendation**: Always use **Private Link** for production. It enables access from on-premise and eliminates the "public" aspect of PaaS entirely.

![Private Link Architecture](/images/azure/03a-privatelink-flow.svg)

---

## 4. Subnet Delegation

Some Azure services require a "Delegated Subnet". This means they take full control of that subnetâ€”you cannot put anything else in it.

**Services requiring delegation**:
- Azure NetApp Files
- Azure SQL Managed Instance
- App Service VNet Integration (Standard)
- Azure Databricks

> [!WARNING]
> **Gotcha: Subnet Delegation sizing**
> Once delegated, resizing is painful. Azure SQL Managed Instance requires a minimum `/27`, but Microsoft recommends `/26` or `/25` for scaling. If you start too small, you have to rebuild the cluster.

---

## 5. VNet Peering

Connecting two VNets together.

### Local Peering vs Global Peering
- **Local**: Same region (High bandwidth, negligible latency).
- **Global**: Across regions (e.g., East US to West Europe). Traffic stays on Microsoft backbone, never hits public internet.

**Key constraints**:
- **Non-overlapping CIDRs**: You cannot peer `10.0.0.0/16` with another `10.0.0.0/16`.
- **Transitivity**: Peering is **non-transitive**.
  - If A peers with B
  - And B peers with C
  - **A cannot talk to C** (unless you use a Gateway in B or use Virtual WAN).

> [!TIP]
> **Jargon Alert: Transitive Routing**
> The ability for traffic to pass *through* a network to get to another. Native VNet peering does NOT support this. You need an NVA (Firewall) or VPN Gateway to act as a router (Hub-and-Spoke topology).
