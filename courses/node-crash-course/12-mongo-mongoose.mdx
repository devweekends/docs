---
title: "12. MongoDB & Mongoose ORM"
description: "Connect Node.js to MongoDB using Mongoose."
---

# MongoDB & Mongoose

**MongoDB** is a NoSQL database that stores data in JSON-like documents. **Mongoose** is an Object Data Modeling (ODM) library for MongoDB and Node.js. It manages relationships between data, provides schema validation, and is used to translate between objects in code and the representation of those objects in MongoDB.

## Setup

1.  Install Mongoose:
    ```bash
    npm install mongoose
    ```
2.  Ensure you have a MongoDB instance running (local or Atlas).

## Connecting to MongoDB

```javascript
const mongoose = require('mongoose');

const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGO_URI);
    console.log('MongoDB Connected...');
  } catch (err) {
    console.error(err.message);
    process.exit(1);
  }
};

connectDB();
```

## Defining a Schema

Everything in Mongoose starts with a Schema. Each schema maps to a MongoDB collection and defines the shape of the documents within that collection.

**models/User.js**
```javascript
const mongoose = require('mongoose');

const UserSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true
  },
  email: {
    type: String,
    required: true,
    unique: true
  },
  password: {
    type: String,
    required: true
  },
  date: {
    type: Date,
    default: Date.now
  }
});

module.exports = mongoose.model('User', UserSchema);
```

## CRUD Operations with Mongoose

### Create

```javascript
const User = require('./models/User');

const newUser = new User({
  name: 'John Doe',
  email: 'john@example.com',
  password: 'hashedpassword123'
});

await newUser.save();
```

### Read

```javascript
// Find all
const users = await User.find();

// Find one by criteria
const user = await User.findOne({ email: 'john@example.com' });

// Find by ID
const userById = await User.findById('60d5ec...');
```

### Update

```javascript
// Find and update
const updatedUser = await User.findByIdAndUpdate(
  id,
  { $set: { name: 'Jane Doe' } },
  { new: true } // Return the updated document
);
```

### Delete

```javascript
await User.findByIdAndDelete(id);
```

## Relationships (Population)

Mongoose allows you to reference documents in other collections.

```javascript
const PostSchema = new mongoose.Schema({
  user: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User'
  },
  title: String
});

// ...

// Fetch posts and populate user data
const posts = await Post.find().populate('user', ['name', 'email']);
```

## Summary

- **Mongoose** simplifies MongoDB interactions.
- **Schemas** define the structure of your data.
- **Models** are compiled from schemas and used for database operations.
- Use `populate()` to handle relationships between collections.
