---
title: "13. PostgreSQL & Prisma ORM"
description: "Connect Node.js to PostgreSQL using Prisma ORM."
---

# PostgreSQL & Prisma

**PostgreSQL** is a powerful, open-source relational database system. **Prisma** is a next-generation ORM that consists of the Prisma Client, Prisma Migrate, and Prisma Studio.

## Setup

1.  Install Prisma CLI as a dev dependency:
    ```bash
    npm install prisma --save-dev
    ```

2.  Initialize Prisma:
    ```bash
    npx prisma init
    ```
    This creates a `prisma` directory with `schema.prisma` and creates a `.env` file.

3.  Update `.env` with your PostgreSQL connection string:
    ```
    DATABASE_URL="postgresql://user:password@localhost:5432/mydb?schema=public"
    ```

## Defining the Schema

Edit `prisma/schema.prisma` to define your data model.

```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  name      String?
  posts     Post[]
  createdAt DateTime @default(now())
}

model Post {
  id        Int      @id @default(autoincrement())
  title     String
  content   String?
  published Boolean  @default(false)
  author    User     @relation(fields: [authorId], references: [id])
  authorId  Int
}
```

## Migrations

To map your data model to the database schema, run a migration.

```bash
npx prisma migrate dev --name init
```

This creates the SQL tables and generates the Prisma Client.

## Using Prisma Client

Install the client:
```bash
npm install @prisma/client
```

Use it in your code:

```javascript
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

async function main() {
  // ... database queries
}
```

## CRUD Operations

### Create

```javascript
const newUser = await prisma.user.create({
  data: {
    name: 'Alice',
    email: 'alice@prisma.io',
    posts: {
      create: { title: 'Hello World' },
    },
  },
});
```

### Read

```javascript
// Find all users
const users = await prisma.user.findMany({
  include: {
    posts: true, // Include relations
  },
});

// Find unique
const user = await prisma.user.findUnique({
  where: {
    email: 'alice@prisma.io',
  },
});
```

### Update

```javascript
const updatedUser = await prisma.user.update({
  where: { id: 1 },
  data: { name: 'Alice Wonderland' },
});
```

### Delete

```javascript
const deletedUser = await prisma.user.delete({
  where: { id: 1 },
});
```

## Summary

- **Prisma** provides a type-safe database client.
- **schema.prisma** is the single source of truth for your data model.
- **Migrations** keep your database schema in sync with your Prisma schema.
- Prisma Client's auto-completion makes database queries easy and less error-prone.
