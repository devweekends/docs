---
title: "02. Modules System"
description: "Understand the Node.js module system, CommonJS, and how to create reusable code."
---

# Modules in Node.js

Modules are the blocks of encapsulated code that communicate with an external application on the basis of their related functionality. Modules can be a single file or a collection of multiple files/folders.

Node.js uses the **CommonJS** module system by default, though it also supports **ES Modules** (ESM) in newer versions.

## The `require` Function

To include a module, use the `require()` function with the name of the module.

```javascript
const fs = require('fs'); // Built-in module
```

## Creating Custom Modules

Let's create a simple module that exports some math functions.

**math.js**
```javascript
const add = (a, b) => a + b;
const subtract = (a, b) => a - b;

// Exporting functions
module.exports = {
  add,
  subtract
};
```

**app.js**
```javascript
const math = require('./math');

console.log(math.add(5, 3));      // Output: 8
console.log(math.subtract(5, 3)); // Output: 2
```

### Alternative Export Syntax

You can also attach properties directly to `exports` (which is a shorthand for `module.exports`).

```javascript
exports.multiply = (a, b) => a * b;
exports.divide = (a, b) => a / b;
```

## Module Wrapper Function

Under the hood, Node.js doesn't execute your code directly. It wraps it inside a function wrapper:

```javascript
(function(exports, require, module, __filename, __dirname) {
  // Your module code actually lives in here
});
```

This is why variables defined in a module are scoped to that module (private) rather than being global.

## Built-in Modules

Node.js comes with many useful built-in modules. We will explore these in depth in later chapters, but here are a few common ones:

- `fs`: File system operations.
- `http`: Create HTTP servers.
- `path`: Utilities for working with file and directory paths.
- `os`: Operating system information.
- `events`: Event emitter.

### Example: The `os` Module

```javascript
const os = require('os');

console.log('Platform:', os.platform());
console.log('Architecture:', os.arch());
console.log('Free Memory:', os.freemem());
console.log('Total Memory:', os.totalmem());
console.log('Uptime:', os.uptime());
```

## ES Modules (import/export)

Node.js has added support for ES Modules, which is the standard in modern JavaScript (and browsers).

To use ES Modules, you can either:
1.  Use the `.mjs` extension for your files.
2.  Add `"type": "module"` to your `package.json`.

**math.mjs**
```javascript
export const add = (a, b) => a + b;
export default function log(msg) {
  console.log(msg);
}
```

**app.mjs**
```javascript
import log, { add } from './math.mjs';

log('Hello ES Modules');
console.log(add(2, 2));
```

## Summary

- **Modules** allow you to organize code into reusable files.
- **CommonJS** (`require`, `module.exports`) is the default system in Node.js.
- **ES Modules** (`import`, `export`) are also supported and becoming more common.
- Node.js wraps every module in a **wrapper function**, providing local scope and variables like `__dirname`.
- There are many **built-in modules** like `os`, `path`, `fs`, etc.
