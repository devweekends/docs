---
title: "Boot Process"
sidebarTitle: "Boot Process"
description: "From power-on to running OS: BIOS/UEFI, bootloaders, kernel loading, and init systems"
icon: "power-off"
---

# System Boot Process

The **boot process** transforms a powered-off machine into a running operating system. Understanding this sequence is essential for systems engineers debugging boot issues, configuring servers, and understanding system initialization.

<Info>
**Interview Frequency**: Medium  
**Key Topics**: BIOS vs UEFI, bootloaders, kernel parameters, init systems  
**Time to Master**: 6-8 hours
</Info>

---

## Boot Sequence Overview

```
┌─────────────────────────────────────────────────────────────────┐
│                    COMPLETE BOOT SEQUENCE                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ 1. POWER ON                                               │   │
│  │    • PSU provides power                                   │   │
│  │    • CPU reset vector → firmware                          │   │
│  └────────────────────────┬─────────────────────────────────┘   │
│                           ▼                                      │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ 2. FIRMWARE (BIOS/UEFI)                                   │   │
│  │    • POST (Power-On Self-Test)                            │   │
│  │    • Initialize hardware                                  │   │
│  │    • Find bootable device                                 │   │
│  └────────────────────────┬─────────────────────────────────┘   │
│                           ▼                                      │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ 3. BOOTLOADER (GRUB/systemd-boot)                        │   │
│  │    • Load kernel image                                    │   │
│  │    • Load initial ramdisk (initrd/initramfs)             │   │
│  │    • Pass parameters to kernel                            │   │
│  └────────────────────────┬─────────────────────────────────┘   │
│                           ▼                                      │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ 4. KERNEL INITIALIZATION                                  │   │
│  │    • Decompress kernel                                    │   │
│  │    • Initialize memory management                         │   │
│  │    • Start scheduler                                      │   │
│  │    • Mount initramfs as temporary root                    │   │
│  └────────────────────────┬─────────────────────────────────┘   │
│                           ▼                                      │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ 5. INIT SYSTEM (systemd/SysV init)                       │   │
│  │    • PID 1 — first userspace process                      │   │
│  │    • Mount real root filesystem                           │   │
│  │    • Start system services                                │   │
│  │    • Reach default target (multi-user/graphical)         │   │
│  └──────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Stage 1: Firmware (BIOS vs UEFI)

### BIOS (Legacy)

**Basic Input/Output System** — the original PC firmware:

```
┌─────────────────────────────────────────────────────────────────┐
│                    BIOS BOOT PROCESS                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. CPU starts at reset vector (0xFFFF0)                        │
│  2. Jumps to BIOS ROM code                                      │
│  3. POST (Power-On Self-Test):                                  │
│     • Test RAM                                                  │
│     • Detect hardware (CPU, disks, video)                       │
│     • Initialize devices                                         │
│  4. Find boot device (order in BIOS settings)                   │
│  5. Load MBR (first 512 bytes of disk)                          │
│  6. Execute MBR bootloader code                                  │
│                                                                  │
│  MBR Layout (512 bytes):                                         │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  Bootstrap Code     │  Partition Table  │  Signature    │    │
│  │     (446 bytes)     │   (64 bytes)      │  (2 bytes)    │    │
│  │                     │   4 × 16 bytes    │   0x55AA      │    │
│  └─────────────────────┴───────────────────┴───────────────┘    │
│                                                                  │
│  Limitations:                                                    │
│  • 16-bit real mode                                             │
│  • 1 MB addressable memory                                       │
│  • 4 primary partitions max                                      │
│  • 2 TB disk size limit                                          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### UEFI (Modern)

**Unified Extensible Firmware Interface** — modern replacement for BIOS:

```
┌─────────────────────────────────────────────────────────────────┐
│                    UEFI BOOT PROCESS                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. SEC (Security Phase)                                         │
│     • CPU reset, cache-as-RAM                                   │
│     • Verify firmware integrity                                  │
│                                                                  │
│  2. PEI (Pre-EFI Initialization)                                │
│     • Initialize chipset, memory controller                     │
│     • Discover memory                                            │
│                                                                  │
│  3. DXE (Driver Execution Environment)                          │
│     • Load UEFI drivers                                         │
│     • Initialize devices                                         │
│     • Build system tables                                        │
│                                                                  │
│  4. BDS (Boot Device Selection)                                 │
│     • Read boot variables (NVRAM)                               │
│     • Find EFI System Partition (ESP)                           │
│     • Load EFI bootloader                                        │
│                                                                  │
│  EFI System Partition (FAT32):                                   │
│  /boot/efi/                                                      │
│  └── EFI/                                                        │
│      ├── BOOT/                                                   │
│      │   └── BOOTX64.EFI    ← Default fallback                 │
│      ├── ubuntu/                                                 │
│      │   └── shimx64.efi    ← Ubuntu bootloader                │
│      └── Microsoft/                                              │
│          └── Boot/                                               │
│              └── bootmgfw.efi                                    │
│                                                                  │
│  Advantages over BIOS:                                           │
│  • 64-bit mode, GBs of addressable memory                       │
│  • GPT: 128 partitions, 9.4 ZB disk size                        │
│  • Secure Boot (cryptographic verification)                      │
│  • Network boot, GUI setup                                       │
│  • Modular drivers                                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### BIOS vs UEFI Comparison

| Feature | BIOS | UEFI |
|---------|------|------|
| Mode | 16-bit real mode | 32/64-bit protected mode |
| Partition table | MBR | GPT |
| Max disk size | 2 TB | 9.4 ZB |
| Max partitions | 4 primary | 128 |
| Boot code location | MBR (446 bytes) | ESP (FAT32 partition) |
| Secure Boot | No | Yes |
| Network boot | Limited | Native |
| Boot time | Slower | Faster |

---

## Stage 2: Bootloader

### GRUB 2 (Grand Unified Bootloader)

The most common Linux bootloader:

```
┌─────────────────────────────────────────────────────────────────┐
│                    GRUB 2 BOOT STAGES                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  BIOS Mode:                                                      │
│  ┌────────────────────────────────────────────────────────┐     │
│  │ Stage 1: boot.img (MBR, 446 bytes)                     │     │
│  │ • Loads Stage 1.5                                       │     │
│  └───────────────────────────┬────────────────────────────┘     │
│                              ▼                                   │
│  ┌────────────────────────────────────────────────────────┐     │
│  │ Stage 1.5: core.img (post-MBR gap or partition)       │     │
│  │ • Filesystem drivers                                    │     │
│  │ • Loads Stage 2                                         │     │
│  └───────────────────────────┬────────────────────────────┘     │
│                              ▼                                   │
│  ┌────────────────────────────────────────────────────────┐     │
│  │ Stage 2: /boot/grub/* (full GRUB)                     │     │
│  │ • Read grub.cfg                                         │     │
│  │ • Display menu                                          │     │
│  │ • Load kernel + initrd                                  │     │
│  └────────────────────────────────────────────────────────┘     │
│                                                                  │
│  UEFI Mode:                                                      │
│  ┌────────────────────────────────────────────────────────┐     │
│  │ grubx64.efi (on ESP)                                   │     │
│  │ • Single EFI application                                │     │
│  │ • Contains all GRUB functionality                       │     │
│  └────────────────────────────────────────────────────────┘     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### GRUB Configuration

```bash
# /boot/grub/grub.cfg (auto-generated, don't edit directly)
# Edit /etc/default/grub instead

# /etc/default/grub
GRUB_DEFAULT=0                    # Default menu entry
GRUB_TIMEOUT=5                    # Seconds to wait
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
GRUB_CMDLINE_LINUX=""             # Always applied

# Regenerate grub.cfg after changes
sudo update-grub  # Debian/Ubuntu
sudo grub2-mkconfig -o /boot/grub2/grub.cfg  # RHEL/Fedora
```

### Important Kernel Parameters

```bash
# Common kernel command line parameters
root=/dev/sda2          # Root filesystem
ro                      # Mount root read-only initially
quiet                   # Suppress boot messages
splash                  # Show graphical splash screen
init=/bin/bash          # Override init (recovery)
single                  # Single-user mode
nomodeset               # Disable kernel mode setting
mem=4G                  # Limit usable memory
maxcpus=2               # Limit CPUs
console=ttyS0,115200    # Serial console
systemd.unit=rescue.target  # Boot to rescue mode

# View current parameters
cat /proc/cmdline
```

### Other Bootloaders

| Bootloader | Use Case |
|------------|----------|
| **GRUB 2** | Most Linux distributions |
| **systemd-boot** | Simple UEFI-only, used by Arch, Pop!_OS |
| **LILO** | Legacy, rarely used now |
| **rEFInd** | Multi-boot with nice GUI |
| **Syslinux** | Lightweight, USB/CD boot |
| **U-Boot** | Embedded systems, ARM |

---

## Stage 3: Kernel Initialization

### Kernel Loading

```
┌─────────────────────────────────────────────────────────────────┐
│                    KERNEL LOADING PROCESS                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Bootloader loads:                                               │
│  1. vmlinuz (compressed kernel image)                           │
│  2. initrd/initramfs (initial RAM disk)                         │
│                                                                  │
│  Kernel image structure:                                         │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  Boot sector  │  Setup code  │  Compressed kernel       │    │
│  │  (legacy)     │  (real mode) │  (protected mode)        │    │
│  └───────────────┴──────────────┴──────────────────────────┘    │
│                                                                  │
│  Decompression:                                                  │
│  1. Setup code switches to protected mode                        │
│  2. Decompresses kernel to fixed address                         │
│  3. Jumps to kernel entry point                                  │
│                                                                  │
│  Kernel start (start_kernel):                                    │
│  • Initialize memory management                                  │
│  • Set up interrupt handlers                                     │
│  • Initialize scheduler                                          │
│  • Start kernel threads                                          │
│  • Mount initramfs                                               │
│  • Execute /init from initramfs                                  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### initramfs (Initial RAM Filesystem)

```
┌─────────────────────────────────────────────────────────────────┐
│                    INITRAMFS PURPOSE                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Problem: Kernel needs drivers to mount root, but drivers       │
│           might be on the root filesystem!                       │
│                                                                  │
│  Solution: initramfs is a minimal filesystem in RAM with        │
│            essential drivers and tools                           │
│                                                                  │
│  Contents of initramfs:                                          │
│  /                                                               │
│  ├── bin/                  # Busybox, essential binaries        │
│  ├── sbin/                 # udevd, modprobe                    │
│  ├── lib/                  # Shared libraries                   │
│  ├── lib/modules/          # Kernel modules                     │
│  │   └── 5.15.0/                                                │
│  │       ├── ext4.ko       # Filesystem drivers                 │
│  │       ├── ahci.ko       # Disk controller drivers            │
│  │       └── ...                                                │
│  ├── etc/                  # Configuration                      │
│  ├── init                  # First script to run                │
│  └── dev/, proc/, sys/     # Virtual filesystems                │
│                                                                  │
│  Flow:                                                           │
│  1. Kernel unpacks initramfs to RAM                             │
│  2. Runs /init script                                            │
│  3. init loads necessary modules                                 │
│  4. init mounts real root filesystem                            │
│  5. init does switch_root to real root                          │
│  6. Executes real /sbin/init (systemd)                          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Examining initramfs

```bash
# List contents
lsinitramfs /boot/initrd.img-$(uname -r)  # Debian/Ubuntu
lsinitrd /boot/initramfs-$(uname -r).img  # RHEL/Fedora

# Extract and examine
mkdir /tmp/initrd
cd /tmp/initrd
zcat /boot/initrd.img-$(uname -r) | cpio -idmv

# Regenerate initramfs
update-initramfs -u  # Debian/Ubuntu
dracut --force       # RHEL/Fedora
mkinitcpio -P        # Arch Linux
```

---

## Stage 4: Init System

### Evolution of Init Systems

```
┌─────────────────────────────────────────────────────────────────┐
│                    INIT SYSTEM EVOLUTION                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  SysV Init (1983)                                                │
│  └── Upstart (2006, Ubuntu)                                     │
│      └── systemd (2010, most distros now)                       │
│                                                                  │
│  BSD-style init                                                  │
│  └── OpenRC (Gentoo, Alpine)                                    │
│                                                                  │
│  Other:                                                          │
│  • runit (Void Linux)                                           │
│  • s6 (minimal systems)                                         │
│  • launchd (macOS)                                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### SysV Init (Traditional)

```bash
# Runlevels
0 - Halt
1 - Single-user mode
2 - Multi-user without networking
3 - Multi-user with networking
4 - Unused/custom
5 - Multi-user with GUI
6 - Reboot

# Boot process
# 1. /sbin/init reads /etc/inittab
# 2. Runs /etc/rc.d/rc.sysinit (system initialization)
# 3. Runs scripts for target runlevel: /etc/rc.d/rc3.d/

# Script naming convention
/etc/rc3.d/
├── K01bluetooth   # K = Kill (stop), 01 = order
├── S01sysstat     # S = Start, 01 = order
├── S10network
└── S99local

# All are symlinks to /etc/init.d/servicename
```

### systemd (Modern)

```
┌─────────────────────────────────────────────────────────────────┐
│                    SYSTEMD ARCHITECTURE                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Core Components:                                                │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                      systemd (PID 1)                      │  │
│  │  • Service manager                                        │  │
│  │  • Socket/device activation                               │  │
│  │  • Parallelized boot                                      │  │
│  │  • Dependency management                                   │  │
│  └───────────────────────────────────────────────────────────┘  │
│                              │                                   │
│     ┌────────────────────────┼────────────────────────┐         │
│     │                        │                        │         │
│     ▼                        ▼                        ▼         │
│  ┌─────────┐           ┌──────────┐           ┌────────────┐   │
│  │journald │           │ logind   │           │ networkd   │   │
│  │(logging)│           │(sessions)│           │(networking)│   │
│  └─────────┘           └──────────┘           └────────────┘   │
│                                                                  │
│  Unit Types:                                                     │
│  • .service  - Daemons and processes                            │
│  • .socket   - Socket activation                                │
│  • .target   - Groups of units (like runlevels)                 │
│  • .mount    - Mount points                                     │
│  • .timer    - Scheduled tasks (like cron)                      │
│  • .path     - Path-based activation                            │
│  • .device   - Device units                                     │
│  • .slice    - Resource management (cgroups)                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### systemd Boot Targets

```bash
# Targets replace runlevels
poweroff.target    # Runlevel 0
rescue.target      # Runlevel 1
multi-user.target  # Runlevel 3
graphical.target   # Runlevel 5
reboot.target      # Runlevel 6

# Check current target
systemctl get-default

# Change default target
systemctl set-default multi-user.target

# Switch target immediately
systemctl isolate rescue.target
```

### systemd Service Files

```ini
# /etc/systemd/system/myapp.service
[Unit]
Description=My Application
Documentation=https://example.com/docs
After=network.target postgresql.service
Requires=postgresql.service

[Service]
Type=simple
User=myapp
Group=myapp
WorkingDirectory=/opt/myapp
ExecStart=/opt/myapp/bin/server --config /etc/myapp/config.yaml
ExecReload=/bin/kill -HUP $MAINPID
Restart=on-failure
RestartSec=5
StandardOutput=journal
StandardError=journal

# Security hardening
NoNewPrivileges=yes
ProtectSystem=strict
ProtectHome=yes
PrivateTmp=yes

[Install]
WantedBy=multi-user.target
```

### systemd Commands

```bash
# Service management
systemctl start nginx           # Start service
systemctl stop nginx            # Stop service
systemctl restart nginx         # Restart
systemctl reload nginx          # Reload config
systemctl status nginx          # Show status
systemctl enable nginx          # Enable at boot
systemctl disable nginx         # Disable at boot
systemctl is-enabled nginx      # Check if enabled

# System commands
systemctl poweroff              # Shutdown
systemctl reboot                # Reboot
systemctl suspend               # Suspend
systemctl hibernate             # Hibernate

# Diagnostics
systemctl list-units            # List active units
systemctl list-unit-files       # List all units
systemctl list-dependencies     # Show dependencies
systemctl --failed              # Show failed units
systemd-analyze                 # Boot time analysis
systemd-analyze blame           # Time per service
systemd-analyze critical-chain  # Critical path

# Logs
journalctl -u nginx             # Logs for unit
journalctl -f                   # Follow logs
journalctl -b                   # Current boot
journalctl --since "1 hour ago" # Time filter
```

---

## Boot Time Optimization

### Analyzing Boot Time

```bash
# Overall boot time
$ systemd-analyze
Startup finished in 3.456s (firmware) + 1.234s (loader) + 
                   2.345s (kernel) + 5.678s (userspace) = 12.713s

# Per-service breakdown
$ systemd-analyze blame
          5.012s NetworkManager-wait-online.service
          2.345s docker.service
          1.234s snapd.service
          ...

# Critical path
$ systemd-analyze critical-chain
graphical.target @5.678s
└─multi-user.target @5.678s
  └─docker.service @3.333s +2.345s
    └─network.target @3.332s
      └─NetworkManager.service @2.123s +1.209s
```

### Optimization Techniques

```bash
# 1. Disable unnecessary services
systemctl disable bluetooth
systemctl mask NetworkManager-wait-online.service

# 2. Use socket activation (defer startup)
# Service starts only when socket is accessed

# 3. Reduce kernel modules in initramfs
# /etc/initramfs-tools/modules - only needed modules

# 4. Use faster filesystem
# ext4 with fast_commit, or XFS

# 5. Parallel service startup (systemd default)
# Ensure proper After=/Requires= dependencies

# 6. Profile boot with bootchart
systemd-bootchart
```

---

## Troubleshooting Boot Issues

### Common Problems

```
┌─────────────────────────────────────────────────────────────────┐
│                    BOOT TROUBLESHOOTING                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Symptom                    Likely Cause                         │
│  ────────────────────────   ─────────────────────────────────   │
│  No POST                    Hardware (PSU, RAM, CPU)            │
│  BIOS but no bootloader     MBR/ESP corrupted, wrong boot order │
│  GRUB rescue prompt         Missing grub files                  │
│  Kernel panic               Missing initramfs, wrong root=      │
│  initramfs drops to shell   Can't find/mount root filesystem    │
│  systemd emergency mode     Failed mounts, bad fstab            │
│  Hangs at starting X        GPU driver issues                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Recovery Techniques

```bash
# Boot to rescue mode
# In GRUB: edit entry, add 'single' or 'init=/bin/bash'

# Fix GRUB
# Boot from live USB
mount /dev/sda2 /mnt
mount /dev/sda1 /mnt/boot/efi  # If UEFI
for i in /dev /dev/pts /proc /sys /run; do
    mount -B $i /mnt$i
done
chroot /mnt
grub-install /dev/sda  # or for UEFI:
grub-install --target=x86_64-efi --efi-directory=/boot/efi
update-grub
exit
reboot

# Fix initramfs
chroot /mnt
update-initramfs -u -k all

# Fix fstab (common boot hang cause)
# Boot with init=/bin/bash
mount -o remount,rw /
vim /etc/fstab  # Fix or comment out bad entries
reboot

# View boot logs after recovery
journalctl -b -1  # Previous boot
journalctl -xb     # Current boot with explanations
```

---

## Interview Questions

<AccordionGroup>
  <Accordion title="What happens when you press the power button?">
    **Answer:**
    1. PSU provides power, CPU reset vector loads firmware
    2. BIOS/UEFI POST tests hardware
    3. Firmware finds boot device, loads bootloader
    4. Bootloader (GRUB) loads kernel + initramfs
    5. Kernel initializes hardware, mounts initramfs
    6. initramfs /init finds and mounts real root
    7. systemd (PID 1) starts and brings up services
    8. Login prompt or display manager appears
  </Accordion>
  
  <Accordion title="What is the difference between BIOS and UEFI?">
    **Key differences:**
    - **Mode**: BIOS is 16-bit real mode, UEFI is 32/64-bit
    - **Partition**: BIOS uses MBR (2TB limit), UEFI uses GPT
    - **Boot code**: BIOS in MBR (446 bytes), UEFI in ESP (FAT32)
    - **Security**: UEFI has Secure Boot
    - **Speed**: UEFI boots faster
    - **Interface**: UEFI has graphical setup, network boot
  </Accordion>
  
  <Accordion title="Why do we need initramfs?">
    **Answer:**
    The kernel needs drivers to mount the root filesystem, but those drivers might be on the root filesystem (chicken-and-egg problem).
    
    initramfs is a temporary root filesystem in RAM containing:
    - Essential kernel modules (disk, filesystem drivers)
    - Tools to find and mount the real root
    - Support for LVM, RAID, encryption
    
    After mounting the real root, initramfs switches to it.
  </Accordion>
  
  <Accordion title="How does systemd improve over SysV init?">
    **Improvements:**
    - **Parallel startup**: Dependencies allow concurrent start
    - **Socket activation**: Services start on-demand
    - **Unified logging**: journald replaces multiple log files
    - **cgroups**: Resource management per service
    - **Declarative**: Unit files vs shell scripts
    - **Dependency management**: Automatic ordering
    - **Transactional**: Start/stop is all-or-nothing
  </Accordion>
</AccordionGroup>

---

## Summary

```
┌─────────────────────────────────────────────────────────────────┐
│                    BOOT PROCESS SUMMARY                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Stage       │ Component        │ Key Files                     │
│  ───────────────────────────────────────────────────────────    │
│  Firmware    │ BIOS/UEFI        │ ROM, NVRAM                    │
│  Bootloader  │ GRUB             │ /boot/grub/grub.cfg           │
│  Kernel      │ Linux            │ /boot/vmlinuz-*               │
│  initramfs   │ Initial root     │ /boot/initrd.img-*            │
│  Init        │ systemd          │ /etc/systemd/system/*         │
│                                                                  │
│  Key Commands:                                                   │
│  • systemd-analyze      - Boot time analysis                    │
│  • journalctl -b        - Boot logs                             │
│  • update-grub          - Regenerate GRUB config                │
│  • update-initramfs -u  - Regenerate initramfs                  │
│  • systemctl            - Manage services                       │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```
