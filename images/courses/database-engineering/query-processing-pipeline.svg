<svg width="1080" height="1080" viewBox="0 0 1080 1080" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="5" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0EA5E9"/>
    </marker>
  </defs>

  <rect width="1080" height="1080" fill="#18181B"/>

  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#FAFAFA" letter-spacing="3">DEV WEEKENDS</text>

  <rect x="60" y="140" width="260" height="40" fill="#0EA5E9"/>
  <text x="190" y="168" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#FAFAFA" text-anchor="middle" letter-spacing="2">DATABASE ENGINEERING</text>

  <text x="60" y="280" font-family="system-ui, sans-serif" font-size="48" font-weight="700" fill="#FAFAFA">Query</text>
  <text x="60" y="340" font-family="system-ui, sans-serif" font-size="48" font-weight="700" fill="#0EA5E9">Processing</text>

  <text x="60" y="400" font-family="system-ui, sans-serif" font-size="18" fill="#A1A1AA">From SQL text to result set</text>

  <!-- Main diagram area -->
  <rect x="60" y="440" width="960" height="540" fill="#27272A" rx="8"/>

  <!-- SQL Input -->
  <rect x="350" y="470" width="380" height="50" fill="#3F3F46" rx="8"/>
  <text x="540" y="502" font-family="monospace" font-size="12" fill="#22C55E" text-anchor="middle">SELECT name FROM users WHERE id = 5</text>

  <path d="M 540 520 L 540 550" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Stage 1: Parser -->
  <rect x="100" y="550" width="880" height="65" fill="#7C3AED" rx="8"/>
  <text x="150" y="575" font-family="system-ui, sans-serif" font-size="15" font-weight="600" fill="#FAFAFA">1. PARSER</text>
  <text x="150" y="595" font-family="system-ui, sans-serif" font-size="10" fill="#E9D5FF">Lexical + Syntax</text>

  <rect x="350" y="560" width="260" height="45" fill="#6D28D9" rx="4"/>
  <text x="480" y="577" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">scan.l → tokens</text>
  <text x="480" y="593" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">gram.y → parse tree</text>

  <text x="730" y="585" font-family="system-ui, sans-serif" font-size="9" fill="#E9D5FF">parser/</text>

  <path d="M 540 615 L 540 635" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Stage 2: Analyzer -->
  <rect x="100" y="635" width="880" height="65" fill="#1E40AF" rx="8"/>
  <text x="150" y="660" font-family="system-ui, sans-serif" font-size="15" font-weight="600" fill="#FAFAFA">2. ANALYZER</text>
  <text x="150" y="680" font-family="system-ui, sans-serif" font-size="10" fill="#93C5FD">Semantic Analysis</text>

  <rect x="350" y="645" width="260" height="45" fill="#1E3A8A" rx="4"/>
  <text x="480" y="662" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">Resolve names</text>
  <text x="480" y="678" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">Type check → query tree</text>

  <text x="730" y="670" font-family="system-ui, sans-serif" font-size="9" fill="#93C5FD">analyze.c</text>

  <path d="M 540 700 L 540 720" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Stage 3: Rewriter -->
  <rect x="100" y="720" width="880" height="65" fill="#166534" rx="8"/>
  <text x="150" y="745" font-family="system-ui, sans-serif" font-size="15" font-weight="600" fill="#FAFAFA">3. REWRITER</text>
  <text x="150" y="765" font-family="system-ui, sans-serif" font-size="10" fill="#BBF7D0">Views & Rules</text>

  <rect x="350" y="730" width="260" height="45" fill="#14532D" rx="4"/>
  <text x="480" y="747" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">Expand views</text>
  <text x="480" y="763" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">Apply rules</text>

  <text x="730" y="755" font-family="system-ui, sans-serif" font-size="9" fill="#BBF7D0">rewrite/</text>

  <path d="M 540 785 L 540 805" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Stage 4: Planner/Optimizer -->
  <rect x="100" y="805" width="410" height="75" fill="#9A3412" rx="8"/>
  <text x="150" y="830" font-family="system-ui, sans-serif" font-size="15" font-weight="600" fill="#FAFAFA">4. PLANNER</text>
  <text x="150" y="850" font-family="system-ui, sans-serif" font-size="10" fill="#FED7AA">Cost-Based Optimization</text>

  <circle cx="165" cy="865" r="2" fill="#F97316"/>
  <text x="173" y="868" font-family="system-ui, sans-serif" font-size="8" fill="#E5E5E5">Generate paths</text>
  <circle cx="280" cy="865" r="2" fill="#F97316"/>
  <text x="288" y="868" font-family="system-ui, sans-serif" font-size="8" fill="#E5E5E5">Cost estimate</text>

  <text x="400" y="870" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA">optimizer/</text>

  <!-- Stage 5: Executor -->
  <rect x="570" y="805" width="410" height="75" fill="#0F172A" rx="8"/>
  <text x="620" y="830" font-family="system-ui, sans-serif" font-size="15" font-weight="600" fill="#FAFAFA">5. EXECUTOR</text>
  <text x="620" y="850" font-family="system-ui, sans-serif" font-size="10" fill="#A1A1AA">Pipeline Execution</text>

  <circle cx="635" cy="865" r="2" fill="#0EA5E9"/>
  <text x="643" y="868" font-family="system-ui, sans-serif" font-size="8" fill="#E5E5E5">Initialize nodes</text>
  <circle cx="760" cy="865" r="2" fill="#0EA5E9"/>
  <text x="768" y="868" font-family="system-ui, sans-serif" font-size="8" fill="#E5E5E5">Process tuples</text>

  <text x="870" y="870" font-family="system-ui, sans-serif" font-size="8" fill="#A1A1AA">executor/</text>

  <!-- Arrows from planner/executor -->
  <path d="M 305 880 L 305 905 L 540 905 L 540 925" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M 775 880 L 775 905 L 540 905" stroke="#0EA5E9" stroke-width="3"/>

  <!-- Result -->
  <rect x="350" y="925" width="380" height="45" fill="#22C55E" rx="8"/>
  <text x="540" y="953" font-family="monospace" font-size="11" fill="#FAFAFA" text-anchor="middle">Result: {name: "Alice"}</text>

  <text x="540" y="1055" font-family="system-ui, sans-serif" font-size="14" fill="#52525B" text-anchor="middle">@devweekends</text>
</svg>
