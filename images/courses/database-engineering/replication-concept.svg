<svg viewBox="0 0 1080 1080" xmlns="http://www.w3.org/2000/svg">
  <rect width="1080" height="1080" fill="#FAFAFA"/>
  
  <!-- Branding -->
  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#18181B" letter-spacing="3">DEV WEEKENDS</text>
  
  <!-- Title -->
  <text x="540" y="140" font-family="system-ui, sans-serif" font-size="36" font-weight="700" fill="#18181B" text-anchor="middle">Database Replication</text>
  <text x="540" y="175" font-family="system-ui, sans-serif" font-size="18" fill="#71717A" text-anchor="middle">Synchronous vs Asynchronous, streaming replication, and failover</text>
  
  <!-- Replication types -->
  <rect x="80" y="210" width="440" height="280" rx="16" fill="#3B82F6" opacity="0.1" stroke="#3B82F6" stroke-width="2"/>
  <text x="300" y="245" font-family="system-ui, sans-serif" font-size="18" font-weight="600" fill="#3B82F6" text-anchor="middle">Synchronous Replication</text>
  
  <!-- Sync flow -->
  <rect x="110" y="270" width="120" height="60" rx="8" fill="#3B82F6"/>
  <text x="170" y="300" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Primary</text>
  <text x="170" y="318" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">COMMIT</text>
  
  <path d="M235 300 L275 300" stroke="#3B82F6" stroke-width="2" marker-end="url(#arrow-blue)"/>
  <text x="255" y="290" font-family="system-ui, sans-serif" font-size="9" fill="#3B82F6" text-anchor="middle">WAL</text>
  
  <rect x="280" y="270" width="120" height="60" rx="8" fill="#22C55E"/>
  <text x="340" y="300" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Standby</text>
  <text x="340" y="318" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Apply</text>
  
  <path d="M340 335 L340 360 L170 360 L170 335" stroke="#22C55E" stroke-width="2" marker-end="url(#arrow-green)"/>
  <text x="255" y="375" font-family="system-ui, sans-serif" font-size="9" fill="#22C55E" text-anchor="middle">ACK</text>
  
  <!-- Sync characteristics -->
  <rect x="110" y="400" width="380" height="75" rx="8" fill="#FAFAFA" stroke="#3B82F6" stroke-width="2"/>
  <text x="130" y="425" font-family="system-ui, sans-serif" font-size="11" fill="#22C55E" font-weight="600">✓ Zero data loss (RPO = 0)</text>
  <text x="130" y="445" font-family="system-ui, sans-serif" font-size="11" fill="#22C55E" font-weight="600">✓ Strong consistency</text>
  <text x="130" y="465" font-family="system-ui, sans-serif" font-size="11" fill="#EF4444" font-weight="600">✗ Higher latency (wait for standby)</text>
  
  <!-- Async replication -->
  <rect x="560" y="210" width="440" height="280" rx="16" fill="#A855F7" opacity="0.1" stroke="#A855F7" stroke-width="2"/>
  <text x="780" y="245" font-family="system-ui, sans-serif" font-size="18" font-weight="600" fill="#A855F7" text-anchor="middle">Asynchronous Replication</text>
  
  <!-- Async flow -->
  <rect x="590" y="270" width="120" height="60" rx="8" fill="#A855F7"/>
  <text x="650" y="300" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Primary</text>
  <text x="650" y="318" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">COMMIT ✓</text>
  
  <path d="M715 300 L755 300" stroke="#A855F7" stroke-width="2" marker-end="url(#arrow-purple)"/>
  <text x="735" y="290" font-family="system-ui, sans-serif" font-size="9" fill="#A855F7" text-anchor="middle">WAL</text>
  
  <rect x="760" y="270" width="120" height="60" rx="8" fill="#22C55E"/>
  <text x="820" y="300" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Standby</text>
  <text x="820" y="318" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Apply (later)</text>
  
  <text x="900" y="305" font-family="system-ui, sans-serif" font-size="10" fill="#71717A">lag</text>
  
  <!-- Async characteristics -->
  <rect x="590" y="400" width="380" height="75" rx="8" fill="#FAFAFA" stroke="#A855F7" stroke-width="2"/>
  <text x="610" y="425" font-family="system-ui, sans-serif" font-size="11" fill="#22C55E" font-weight="600">✓ Lower latency</text>
  <text x="610" y="445" font-family="system-ui, sans-serif" font-size="11" fill="#22C55E" font-weight="600">✓ Better performance</text>
  <text x="610" y="465" font-family="system-ui, sans-serif" font-size="11" fill="#EF4444" font-weight="600">✗ Potential data loss (RPO > 0)</text>
  
  <!-- Streaming Replication -->
  <rect x="80" y="510" width="920" height="200" rx="16" fill="#22C55E" opacity="0.1" stroke="#22C55E" stroke-width="2"/>
  <text x="540" y="545" font-family="system-ui, sans-serif" font-size="20" font-weight="700" fill="#22C55E" text-anchor="middle">PostgreSQL Streaming Replication</text>
  
  <!-- Architecture -->
  <rect x="110" y="570" width="200" height="120" rx="10" fill="#3B82F6"/>
  <text x="210" y="600" font-family="system-ui, sans-serif" font-size="14" fill="#FAFAFA" font-weight="600" text-anchor="middle">Primary</text>
  <text x="210" y="625" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">WAL Sender process</text>
  <rect x="130" y="645" width="160" height="30" rx="4" fill="#FAFAFA"/>
  <text x="210" y="665" font-family="monospace" font-size="9" fill="#3B82F6" text-anchor="middle">pg_wal/000000010000...</text>
  
  <path d="M315 630 L400 630" stroke="#22C55E" stroke-width="3" marker-end="url(#arrow-green)"/>
  <text x="357" y="620" font-family="system-ui, sans-serif" font-size="10" fill="#22C55E" font-weight="600" text-anchor="middle">WAL stream</text>
  
  <!-- Standby 1 -->
  <rect x="410" y="570" width="200" height="120" rx="10" fill="#22C55E"/>
  <text x="510" y="600" font-family="system-ui, sans-serif" font-size="14" fill="#FAFAFA" font-weight="600" text-anchor="middle">Standby 1</text>
  <text x="510" y="625" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">WAL Receiver + Startup</text>
  <text x="510" y="645" font-family="system-ui, sans-serif" font-size="9" fill="#FAFAFA" text-anchor="middle">hot_standby = on</text>
  <text x="510" y="665" font-family="system-ui, sans-serif" font-size="9" fill="#FAFAFA" text-anchor="middle">Read queries ✓</text>
  
  <!-- Cascading -->
  <path d="M615 630 L680 630" stroke="#A855F7" stroke-width="2" marker-end="url(#arrow-purple)"/>
  
  <rect x="690" y="570" width="200" height="120" rx="10" fill="#A855F7"/>
  <text x="790" y="600" font-family="system-ui, sans-serif" font-size="14" fill="#FAFAFA" font-weight="600" text-anchor="middle">Standby 2</text>
  <text x="790" y="625" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Cascading replica</text>
  <text x="790" y="645" font-family="system-ui, sans-serif" font-size="9" fill="#FAFAFA" text-anchor="middle">Receives from Standby 1</text>
  <text x="790" y="665" font-family="system-ui, sans-serif" font-size="9" fill="#FAFAFA" text-anchor="middle">Reduces primary load</text>
  
  <!-- Failover -->
  <rect x="80" y="730" width="920" height="230" rx="16" fill="#EF4444" opacity="0.1" stroke="#EF4444" stroke-width="2"/>
  <text x="540" y="765" font-family="system-ui, sans-serif" font-size="20" font-weight="700" fill="#EF4444" text-anchor="middle">Failover & Promotion</text>
  
  <!-- Failover flow -->
  <rect x="110" y="795" width="180" height="70" rx="10" fill="#EF4444"/>
  <text x="200" y="825" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">Primary FAILS</text>
  <text x="200" y="850" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Connection lost</text>
  
  <path d="M295 830 L345 830" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="350" y="795" width="180" height="70" rx="10" fill="#18181B"/>
  <text x="440" y="825" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">Detect Failure</text>
  <text x="440" y="850" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">Patroni, pg_auto_failover</text>
  
  <path d="M535 830 L585 830" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="590" y="795" width="180" height="70" rx="10" fill="#A855F7"/>
  <text x="680" y="820" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">Promote Standby</text>
  <text x="680" y="845" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">pg_ctl promote</text>
  <text x="680" y="860" font-family="monospace" font-size="9" fill="#FAFAFA" text-anchor="middle">trigger_file</text>
  
  <path d="M775 830 L825 830" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="830" y="795" width="150" height="70" rx="10" fill="#22C55E"/>
  <text x="905" y="825" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">New Primary</text>
  <text x="905" y="850" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Accepts writes</text>
  
  <!-- Key metrics -->
  <rect x="110" y="885" width="380" height="60" rx="8" fill="#18181B"/>
  <text x="300" y="915" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">Key Metrics</text>
  <text x="140" y="935" font-family="system-ui, sans-serif" font-size="10" fill="#22C55E">RPO:</text>
  <text x="180" y="935" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA">Max data loss</text>
  <text x="300" y="935" font-family="system-ui, sans-serif" font-size="10" fill="#3B82F6">RTO:</text>
  <text x="340" y="935" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA">Recovery time</text>
  
  <!-- Replication lag monitoring -->
  <rect x="510" y="885" width="470" height="60" rx="8" fill="#FAFAFA" stroke="#22C55E" stroke-width="2"/>
  <text x="745" y="910" font-family="system-ui, sans-serif" font-size="12" fill="#22C55E" font-weight="600" text-anchor="middle">Monitor Replication Lag</text>
  <text x="745" y="935" font-family="monospace" font-size="10" fill="#18181B" text-anchor="middle">SELECT pg_last_wal_receive_lsn() - pg_last_wal_replay_lsn();</text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#18181B"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3B82F6"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22C55E"/>
    </marker>
    <marker id="arrow-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#A855F7"/>
    </marker>
  </defs>
  
  <!-- Footer -->
  <text x="540" y="1040" font-family="system-ui, sans-serif" font-size="14" fill="#71717A" text-anchor="middle">@devweekends</text>
</svg>