<svg width="1080" height="1080" viewBox="0 0 1080 1080" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="ioArrow" markerWidth="10" markerHeight="7" refX="5" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#F97316"/>
    </marker>
  </defs>

  <rect width="1080" height="1080" fill="#18181B"/>

  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#FAFAFA" letter-spacing="3">DEV WEEKENDS</text>

  <rect x="60" y="140" width="240" height="40" fill="#F97316"/>
  <text x="180" y="168" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#FAFAFA" text-anchor="middle" letter-spacing="2">LINUX INTERNALS</text>

  <text x="60" y="260" font-family="system-ui, sans-serif" font-size="52" font-weight="700" fill="#FAFAFA">I/O</text>
  <text x="60" y="315" font-family="system-ui, sans-serif" font-size="52" font-weight="700" fill="#F97316">Stack</text>

  <text x="60" y="365" font-family="system-ui, sans-serif" font-size="16" fill="#A1A1AA">Block layer and I/O schedulers</text>

  <!-- Main diagram area -->
  <rect x="60" y="390" width="960" height="600" fill="#27272A" rx="8"/>

  <!-- User Space -->
  <rect x="100" y="420" width="880" height="70" fill="#7C3AED" rx="8"/>
  <text x="540" y="445" font-family="system-ui, sans-serif" font-size="16" font-weight="700" fill="#FAFAFA" text-anchor="middle">USER SPACE</text>
  <rect x="130" y="460" width="820" height="20" fill="#6D28D9" rx="4"/>
  <text x="540" y="475" font-family="monospace" font-size="10" fill="#E9D5FF" text-anchor="middle">read(fd, buf, size)  /  write(fd, buf, size)  /  io_uring_submit()</text>

  <path d="M 540 490 L 540 520" stroke="#F97316" stroke-width="3" marker-end="url(#ioArrow)"/>

  <!-- VFS -->
  <rect x="100" y="520" width="880" height="60" fill="#1E40AF" rx="8"/>
  <text x="540" y="545" font-family="system-ui, sans-serif" font-size="16" font-weight="700" fill="#FAFAFA" text-anchor="middle">VFS (Virtual File System)</text>
  <rect x="130" y="555" width="820" height="18" fill="#1E3A8A" rx="3"/>
  <text x="540" y="567" font-family="system-ui, sans-serif" font-size="9" fill="#BFDBFE" text-anchor="middle">File operations → Filesystem (ext4, XFS, Btrfs) → Page cache check</text>

  <path d="M 540 580 L 540 610" stroke="#F97316" stroke-width="3" marker-end="url(#ioArrow)"/>

  <!-- Block Layer -->
  <rect x="100" y="610" width="880" height="110" fill="#166534" rx="8"/>
  <text x="540" y="635" font-family="system-ui, sans-serif" font-size="16" font-weight="700" fill="#FAFAFA" text-anchor="middle">BLOCK LAYER</text>

  <rect x="130" y="650" width="400" height="60" fill="#14532D" rx="6"/>
  <text x="330" y="670" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#BBF7D0" text-anchor="middle">bio (Block I/O)</text>
  <circle cx="150" cy="685" r="2" fill="#22C55E"/>
  <text x="160" y="688" font-family="system-ui, sans-serif" font-size="8" fill="#BBF7D0">struct bio - I/O request</text>
  <circle cx="150" cy="697" r="2" fill="#22C55E"/>
  <text x="160" y="700" font-family="system-ui, sans-serif" font-size="8" fill="#BBF7D0">bio_vec[] - page vectors</text>

  <rect x="550" y="650" width="400" height="60" fill="#14532D" rx="6"/>
  <text x="750" y="670" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#BBF7D0" text-anchor="middle">Operations</text>
  <circle cx="570" cy="685" r="2" fill="#22C55E"/>
  <text x="580" y="688" font-family="system-ui, sans-serif" font-size="8" fill="#BBF7D0">Split large I/Os</text>
  <circle cx="570" cy="697" r="2" fill="#22C55E"/>
  <text x="580" y="700" font-family="system-ui, sans-serif" font-size="8" fill="#BBF7D0">Merge adjacent requests</text>

  <path d="M 540 720 L 540 750" stroke="#F97316" stroke-width="3" marker-end="url(#ioArrow)"/>

  <!-- I/O Schedulers -->
  <rect x="100" y="750" width="880" height="130" fill="#9A3412" rx="8"/>
  <text x="540" y="775" font-family="system-ui, sans-serif" font-size="16" font-weight="700" fill="#FAFAFA" text-anchor="middle">I/O SCHEDULERS (Request Queue)</text>

  <rect x="130" y="790" width="200" height="75" fill="#7C2D12" rx="6"/>
  <text x="230" y="813" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#FED7AA" text-anchor="middle">mq-deadline</text>
  <text x="230" y="830" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Per-CPU queues</text>
  <text x="230" y="843" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Read/write FIFOs</text>
  <text x="230" y="856" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Deadline priorities</text>

  <rect x="350" y="790" width="200" height="75" fill="#7C2D12" rx="6"/>
  <text x="450" y="813" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#FED7AA" text-anchor="middle">bfq</text>
  <text x="450" y="830" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Budget Fair Queue</text>
  <text x="450" y="843" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Per-process fairness</text>
  <text x="450" y="856" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Interactive workloads</text>

  <rect x="570" y="790" width="190" height="75" fill="#7C2D12" rx="6"/>
  <text x="665" y="813" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#FED7AA" text-anchor="middle">kyber</text>
  <text x="665" y="830" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Latency-based</text>
  <text x="665" y="843" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">NVMe optimized</text>
  <text x="665" y="856" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Token buckets</text>

  <rect x="780" y="790" width="170" height="75" fill="#7C2D12" rx="6"/>
  <text x="865" y="813" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#FED7AA" text-anchor="middle">none</text>
  <text x="865" y="830" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">No reordering</text>
  <text x="865" y="843" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Direct dispatch</text>
  <text x="865" y="856" font-family="system-ui, sans-serif" font-size="8" fill="#FED7AA" text-anchor="middle">Fast SSDs</text>

  <path d="M 540 880 L 540 910" stroke="#F97316" stroke-width="3" marker-end="url(#ioArrow)"/>

  <!-- Device Driver -->
  <rect x="100" y="910" width="880" height="60" fill="#0F172A" rx="8"/>
  <text x="540" y="935" font-family="system-ui, sans-serif" font-size="16" font-weight="700" fill="#FAFAFA" text-anchor="middle">DEVICE DRIVER</text>
  <rect x="130" y="950" width="820" height="12" fill="#1E293B" rx="2"/>
  <text x="540" y="960" font-family="system-ui, sans-serif" font-size="8" fill="#A1A1AA" text-anchor="middle">NVMe / SCSI / virtio-blk / SATA — Program device registers, setup DMA</text>

  <text x="540" y="1055" font-family="system-ui, sans-serif" font-size="14" fill="#52525B" text-anchor="middle">@devweekends</text>
</svg>
