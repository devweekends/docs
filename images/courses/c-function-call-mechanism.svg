<svg width="1080" height="1080" viewBox="0 0 1080 1080" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect width="1080" height="1080" fill="#18181B"/>

  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#FAFAFA" letter-spacing="3">DEV WEEKENDS</text>

  <rect x="60" y="140" width="220" height="40" fill="#10B981"/>
  <text x="170" y="168" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#FAFAFA" text-anchor="middle" letter-spacing="2">C PROGRAMMING</text>

  <text x="60" y="280" font-family="system-ui, sans-serif" font-size="48" font-weight="700" fill="#FAFAFA">Function Call</text>
  <text x="60" y="340" font-family="system-ui, sans-serif" font-size="48" font-weight="700" fill="#10B981">Mechanism</text>

  <text x="60" y="400" font-family="system-ui, sans-serif" font-size="18" fill="#A1A1AA">What happens when you call a function</text>

  <!-- Main diagram area -->
  <rect x="60" y="440" width="960" height="520" fill="#27272A" rx="8"/>

  <!-- Code example -->
  <rect x="100" y="470" width="300" height="180" fill="#3F3F46" rx="8"/>
  <text x="250" y="500" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#10B981" text-anchor="middle">Code Example</text>

  <text x="120" y="530" font-family="monospace" font-size="11" fill="#A855F7">int</text>
  <text x="150" y="530" font-family="monospace" font-size="11" fill="#FAFAFA">add(</text>
  <text x="180" y="530" font-family="monospace" font-size="11" fill="#A855F7">int</text>
  <text x="210" y="530" font-family="monospace" font-size="11" fill="#3B82F6">a</text>
  <text x="225" y="530" font-family="monospace" font-size="11" fill="#FAFAFA">, </text>
  <text x="240" y="530" font-family="monospace" font-size="11" fill="#A855F7">int</text>
  <text x="270" y="530" font-family="monospace" font-size="11" fill="#3B82F6">b</text>
  <text x="285" y="530" font-family="monospace" font-size="11" fill="#FAFAFA">) {</text>

  <text x="140" y="555" font-family="monospace" font-size="11" fill="#A855F7">int</text>
  <text x="170" y="555" font-family="monospace" font-size="11" fill="#FAFAFA">result = a + b;</text>

  <text x="140" y="580" font-family="monospace" font-size="11" fill="#EF4444">return</text>
  <text x="190" y="580" font-family="monospace" font-size="11" fill="#FAFAFA">result;</text>

  <text x="120" y="605" font-family="monospace" font-size="11" fill="#FAFAFA">}</text>

  <text x="120" y="635" font-family="monospace" font-size="11" fill="#A855F7">int</text>
  <text x="150" y="635" font-family="monospace" font-size="11" fill="#FAFAFA">main() {</text>
  <text x="140" y="660" font-family="monospace" font-size="11" fill="#A855F7">int</text>
  <text x="170" y="660" font-family="monospace" font-size="11" fill="#FAFAFA">x = </text>
  <text x="210" y="660" font-family="monospace" font-size="11" fill="#22C55E">add</text>
  <text x="240" y="660" font-family="monospace" font-size="11" fill="#FAFAFA">(5, 3);</text>

  <!-- Step by step -->
  <rect x="430" y="470" width="550" height="470" fill="#18181B" rx="8"/>
  <text x="705" y="505" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="#10B981" text-anchor="middle">Execution Steps</text>

  <!-- Step 1 -->
  <rect x="460" y="520" width="490" height="60" fill="#7C3AED" rx="6"/>
  <text x="490" y="545" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#E9D5FF">1. Push Arguments (right to left)</text>
  <circle cx="475" cy="565" r="2" fill="#A855F7"/>
  <text x="485" y="568" font-family="monospace" font-size="10" fill="#FAFAFA">push 3 onto stack</text>
  <circle cx="655" cy="565" r="2" fill="#A855F7"/>
  <text x="665" y="568" font-family="monospace" font-size="10" fill="#FAFAFA">push 5 onto stack</text>

  <!-- Step 2 -->
  <rect x="460" y="590" width="490" height="60" fill="#1E40AF" rx="6"/>
  <text x="490" y="615" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#93C5FD">2. Call Instruction</text>
  <circle cx="475" cy="635" r="2" fill="#3B82F6"/>
  <text x="485" y="638" font-family="monospace" font-size="10" fill="#FAFAFA">CALL add (pushes return address)</text>

  <!-- Step 3 -->
  <rect x="460" y="660" width="490" height="75" fill="#166534" rx="6"/>
  <text x="490" y="685" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#BBF7D0">3. Function Prologue</text>
  <circle cx="475" cy="705" r="2" fill="#22C55E"/>
  <text x="485" y="708" font-family="monospace" font-size="10" fill="#FAFAFA">push rbp (save old frame pointer)</text>
  <circle cx="475" cy="725" r="2" fill="#22C55E"/>
  <text x="485" y="728" font-family="monospace" font-size="10" fill="#FAFAFA">mov rbp, rsp (set new frame base)</text>

  <!-- Step 4 -->
  <rect x="460" y="745" width="490" height="60" fill="#9A3412" rx="6"/>
  <text x="490" y="770" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#FED7AA">4. Execute Function Body</text>
  <circle cx="475" cy="790" r="2" fill="#F97316"/>
  <text x="485" y="793" font-family="monospace" font-size="10" fill="#FAFAFA">Access params via rbp offset</text>

  <!-- Step 5 -->
  <rect x="460" y="815" width="490" height="60" fill="#7F1D1D" rx="6"/>
  <text x="490" y="840" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#FCA5A5">5. Return Value</text>
  <circle cx="475" cy="860" r="2" fill="#EF4444"/>
  <text x="485" y="863" font-family="monospace" font-size="10" fill="#FAFAFA">mov rax, result (store in register)</text>

  <!-- Step 6 -->
  <rect x="460" y="885" width="490" height="75" fill="#0F172A" rx="6"/>
  <text x="490" y="910" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#A1A1AA">6. Function Epilogue</text>
  <circle cx="475" cy="930" r="2" fill="#71717A"/>
  <text x="485" y="933" font-family="monospace" font-size="10" fill="#FAFAFA">pop rbp (restore frame pointer)</text>
  <circle cx="475" cy="950" r="2" fill="#71717A"/>
  <text x="485" y="953" font-family="monospace" font-size="10" fill="#FAFAFA">RET (pop return address, jump back)</text>

  <!-- Stack visualization -->
  <rect x="100" y="670" width="280" height="270" fill="#18181B" rx="8"/>
  <text x="240" y="700" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#10B981" text-anchor="middle">Stack During Call</text>

  <rect x="130" y="715" width="200" height="30" fill="#3F3F46" rx="4"/>
  <text x="230" y="735" font-family="monospace" font-size="10" fill="#FAFAFA" text-anchor="middle">Argument b = 3</text>

  <rect x="130" y="750" width="200" height="30" fill="#3F3F46" rx="4"/>
  <text x="230" y="770" font-family="monospace" font-size="10" fill="#FAFAFA" text-anchor="middle">Argument a = 5</text>

  <rect x="130" y="785" width="200" height="30" fill="#7C3AED" rx="4"/>
  <text x="230" y="805" font-family="monospace" font-size="10" fill="#E9D5FF" text-anchor="middle">Return address</text>

  <rect x="130" y="820" width="200" height="30" fill="#22C55E" rx="4"/>
  <text x="230" y="840" font-family="monospace" font-size="10" fill="#FAFAFA" text-anchor="middle">Saved rbp</text>

  <rect x="130" y="855" width="200" height="30" fill="#1E40AF" rx="4"/>
  <text x="230" y="875" font-family="monospace" font-size="10" fill="#93C5FD" text-anchor="middle">Local: result</text>

  <path d="M 330 890 L 355 890" stroke="#FBBF24" stroke-width="2" marker-end="url(#arrowStack)"/>
  <text x="365" y="895" font-family="system-ui, sans-serif" font-size="11" fill="#FBBF24">← rsp (stack top)</text>
  <defs>
    <marker id="arrowStack" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#FBBF24"/>
    </marker>
  </defs>

  <path d="M 330" y="840 L 355 840" stroke="#10B981" stroke-width="2" marker-end="url(#arrowFrame)"/>
  <text x="365" y="845" font-family="system-ui, sans-serif" font-size="11" fill="#10B981">← rbp (frame base)</text>
  <defs>
    <marker id="arrowFrame" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10B981"/>
    </marker>
  </defs>

  <!-- Key insight -->
  <rect x="60" y="980" width="960" height="40" fill="#27272A" rx="8"/>
  <text x="540" y="1007" font-family="system-ui, sans-serif" font-size="14" fill="#A1A1AA" text-anchor="middle">Each call creates a new <tspan fill="#10B981">stack frame</tspan> — return values in <tspan fill="#EF4444">rax</tspan> (x86-64 calling convention)</text>

  <text x="540" y="1050" font-family="system-ui, sans-serif" font-size="14" fill="#52525B" text-anchor="middle">@devweekends</text>
</svg>
