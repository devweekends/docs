<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <!-- Background -->
  <rect width="800" height="500" fill="#0f172a" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial, sans-serif" font-size="24" fill="#f8fafc" text-anchor="middle" font-weight="bold">Stack Canary Bypass Techniques</text>
  
  <!-- 1. Information Leak -->
  <g transform="translate(50, 80)">
    <rect width="340" height="180" fill="#1e293b" rx="8" ry="8" stroke="#f43f5e" stroke-width="2"/>
    <text x="20" y="30" font-family="Arial, sans-serif" font-size="18" fill="#fda4af" font-weight="bold">1. Information Leak</text>
    
    <g transform="translate(20, 50)">
      <rect width="300" height="30" fill="#334155" rx="4" ry="4"/>
      <text x="10" y="20" font-family="Consolas, monospace" font-size="12" fill="#e2e8f0">[Buffer] [Canary: <tspan fill="#f43f5e">0x1234</tspan>] ...</text>
    </g>
    
    <text x="20" y="100" font-family="Arial, sans-serif" font-size="14" fill="#e2e8f0">Attacker reads canary value.</text>
    
    <g transform="translate(20, 120)">
      <rect width="300" height="30" fill="#334155" rx="4" ry="4"/>
      <text x="10" y="20" font-family="Consolas, monospace" font-size="12" fill="#e2e8f0">Payload: [AAAA...] [<tspan fill="#f43f5e">0x1234</tspan>] [RET]</text>
    </g>
    <text x="20" y="170" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">Canary preserved during overflow.</text>
  </g>
  
  <!-- 2. Byte-by-Byte Brute Force -->
  <g transform="translate(410, 80)">
    <rect width="340" height="180" fill="#1e293b" rx="8" ry="8" stroke="#f59e0b" stroke-width="2"/>
    <text x="20" y="30" font-family="Arial, sans-serif" font-size="18" fill="#fcd34d" font-weight="bold">2. Brute Force (Forking)</text>
    
    <text x="20" y="60" font-family="Arial, sans-serif" font-size="14" fill="#e2e8f0">Canary same across forks.</text>
    
    <g transform="translate(20, 80)">
      <rect width="40" height="40" fill="#334155" rx="4" ry="4" stroke="#f59e0b"/>
      <text x="20" y="25" font-family="Consolas, monospace" font-size="14" fill="#e2e8f0" text-anchor="middle">?</text>
      <text x="60" y="25" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">Try 0x00..0xFF</text>
    </g>
    
    <g transform="translate(20, 130)">
      <text x="0" y="0" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">1. Guess byte 0. Crash? Retry.</text>
      <text x="0" y="20" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">2. No crash? Byte found!</text>
      <text x="0" y="40" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">3. Move to byte 1.</text>
    </g>
  </g>
  
  <!-- 3. Overwrite Other Data -->
  <g transform="translate(50, 280)">
    <rect width="340" height="180" fill="#1e293b" rx="8" ry="8" stroke="#3b82f6" stroke-width="2"/>
    <text x="20" y="30" font-family="Arial, sans-serif" font-size="18" fill="#60a5fa" font-weight="bold">3. Overwrite Other Data</text>
    
    <g transform="translate(20, 60)">
      <rect width="80" height="40" fill="#334155" rx="4" ry="4"/>
      <text x="40" y="25" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle">Buffer</text>
      
      <rect x="100" y="0" width="80" height="40" fill="#1e3a8a" rx="4" ry="4" stroke="#60a5fa"/>
      <text x="140" y="25" font-family="Arial, sans-serif" font-size="12" fill="#bfdbfe" text-anchor="middle">Func Ptr</text>
      
      <rect x="200" y="0" width="80" height="40" fill="#881337" rx="4" ry="4"/>
      <text x="240" y="25" font-family="Arial, sans-serif" font-size="12" fill="#fecdd3" text-anchor="middle">Canary</text>
    </g>
    
    <path d="M40,40 L140,40" stroke="#f43f5e" stroke-width="2" marker-end="url(#arrow)"/>
    
    <text x="20" y="120" font-family="Arial, sans-serif" font-size="14" fill="#e2e8f0">Overwrite local vars/ptrs</text>
    <text x="20" y="140" font-family="Arial, sans-serif" font-size="14" fill="#e2e8f0">BEFORE the canary.</text>
  </g>
  
  <!-- 4. Canary Null Byte -->
  <g transform="translate(410, 280)">
    <rect width="340" height="180" fill="#1e293b" rx="8" ry="8" stroke="#10b981" stroke-width="2"/>
    <text x="20" y="30" font-family="Arial, sans-serif" font-size="18" fill="#34d399" font-weight="bold">4. Canary Null Byte</text>
    
    <g transform="translate(20, 60)">
      <rect width="300" height="40" fill="#334155" rx="4" ry="4"/>
      <text x="150" y="25" font-family="Consolas, monospace" font-size="14" fill="#e2e8f0" text-anchor="middle">0x<tspan fill="#10b981" font-weight="bold">00</tspan>abcdef12345678</text>
    </g>
    
    <text x="20" y="120" font-family="Arial, sans-serif" font-size="14" fill="#e2e8f0">Stops strcpy() (string copy).</text>
    <text x="20" y="140" font-family="Arial, sans-serif" font-size="14" fill="#f43f5e">Bypassed by memcpy()</text>
    <text x="20" y="160" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">(Attacker can write null bytes)</text>
  </g>
  
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#f43f5e" />
    </marker>
  </defs>
  
</svg>
