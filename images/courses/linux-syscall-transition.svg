<svg width="1080" height="1080" viewBox="0 0 1080 1080" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect width="1080" height="1080" fill="#18181B"/>
  
  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#FAFAFA" letter-spacing="3">DEV WEEKENDS</text>
  
  <rect x="60" y="140" width="220" height="40" fill="#F97316"/>
  <text x="170" y="168" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#FAFAFA" text-anchor="middle" letter-spacing="2">LINUX INTERNALS</text>
  
  <text x="60" y="280" font-family="system-ui, sans-serif" font-size="48" font-weight="700" fill="#FAFAFA">System Call</text>
  <text x="60" y="340" font-family="system-ui, sans-serif" font-size="48" font-weight="700" fill="#F97316">Transition</text>
  
  <text x="60" y="400" font-family="system-ui, sans-serif" font-size="18" fill="#A1A1AA">User space to kernel space and back</text>
  
  <!-- Main diagram -->
  <rect x="60" y="440" width="960" height="540" fill="#27272A" rx="8"/>
  
  <!-- User Space -->
  <rect x="100" y="480" width="880" height="140" fill="#3B82F6" rx="8"/>
  <text x="540" y="520" font-family="system-ui, sans-serif" font-size="20" font-weight="700" fill="#FAFAFA" text-anchor="middle">USER SPACE (Ring 3)</text>
  
  <rect x="150" y="550" width="200" height="50" fill="#1E40AF" rx="4"/>
  <text x="250" y="580" font-family="system-ui, sans-serif" font-size="14" fill="#FAFAFA" text-anchor="middle">Application Code</text>
  
  <rect x="400" y="550" width="200" height="50" fill="#1E40AF" rx="4"/>
  <text x="500" y="580" font-family="system-ui, sans-serif" font-size="14" fill="#FAFAFA" text-anchor="middle">libc (glibc)</text>
  
  <rect x="650" y="550" width="250" height="50" fill="#1E40AF" rx="4"/>
  <text x="775" y="575" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" text-anchor="middle">Wrapper Function</text>
  <text x="775" y="595" font-family="system-ui, sans-serif" font-size="11" fill="#93C5FD" text-anchor="middle">read(), write(), open()</text>
  
  <!-- Transition Layer -->
  <rect x="100" y="640" width="880" height="60" fill="#F59E0B" rx="4"/>
  <text x="540" y="665" font-family="system-ui, sans-serif" font-size="16" font-weight="700" fill="#FAFAFA" text-anchor="middle">SYSTEM CALL INTERFACE</text>
  <text x="540" y="688" font-family="system-ui, sans-serif" font-size="12" fill="#FEF3C7" text-anchor="middle">syscall instruction (x86-64) / int 0x80 (x86-32) / svc (ARM)</text>
  
  <!-- Kernel Space -->
  <rect x="100" y="720" width="880" height="220" fill="#22C55E" rx="8"/>
  <text x="540" y="760" font-family="system-ui, sans-serif" font-size="20" font-weight="700" fill="#FAFAFA" text-anchor="middle">KERNEL SPACE (Ring 0)</text>
  
  <rect x="150" y="780" width="220" height="70" fill="#166534" rx="4"/>
  <text x="260" y="810" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#FAFAFA" text-anchor="middle">System Call Handler</text>
  <text x="260" y="830" font-family="system-ui, sans-serif" font-size="10" fill="#BBF7D0" text-anchor="middle">entry_SYSCALL_64()</text>
  
  <rect x="410" y="780" width="220" height="70" fill="#166534" rx="4"/>
  <text x="520" y="810" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#FAFAFA" text-anchor="middle">Syscall Table Lookup</text>
  <text x="520" y="830" font-family="system-ui, sans-serif" font-size="10" fill="#BBF7D0" text-anchor="middle">sys_call_table[nr]</text>
  
  <rect x="670" y="780" width="220" height="70" fill="#166534" rx="4"/>
  <text x="780" y="810" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#FAFAFA" text-anchor="middle">Kernel Function</text>
  <text x="780" y="830" font-family="system-ui, sans-serif" font-size="10" fill="#BBF7D0" text-anchor="middle">sys_read(), sys_write()</text>
  
  <rect x="150" y="870" width="740" height="50" fill="#065F46" rx="4"/>
  <text x="520" y="900" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" text-anchor="middle">Hardware Access, File Systems, Device Drivers, Network Stack</text>
  
  <!-- Flow arrows -->
  <defs>
    <marker id="arrowdown" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 L3,5 z" fill="#FAFAFA"/>
    </marker>
    <marker id="arrowup" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
      <path d="M10,0 L0,5 L10,10 L7,5 z" fill="#FAFAFA"/>
    </marker>
  </defs>
  
  <!-- Down arrows -->
  <path d="M 250 600 L 250 640" stroke="#FAFAFA" stroke-width="3" marker-end="url(#arrowdown)"/>
  <path d="M 500 600 L 500 640" stroke="#FAFAFA" stroke-width="3" marker-end="url(#arrowdown)"/>
  <path d="M 775 600 L 775 640" stroke="#FAFAFA" stroke-width="3" marker-end="url(#arrowdown)"/>
  
  <path d="M 540 700 L 540 720" stroke="#FAFAFA" stroke-width="3" marker-end="url(#arrowdown)"/>
  
  <path d="M 260 850 L 520 850" stroke="#FAFAFA" stroke-width="2" marker-end="url(#arrowdown)"/>
  <path d="M 520 850 L 780 850" stroke="#FAFAFA" stroke-width="2" marker-end="url(#arrowdown)"/>
  
  <!-- Return path -->
  <path d="M 920 720 L 920 640" stroke="#A855F7" stroke-width="3" stroke-dasharray="8,4" marker-end="url(#arrowup)"/>
  <text x="950" y="680" font-family="system-ui, sans-serif" font-size="12" fill="#A855F7">Return</text>
  
  <!-- Step labels -->
  <text x="120" y="630" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#FEF3C7">1. Call</text>
  <text x="120" y="750" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#BBF7D0">2. Execute</text>
  <text x="950" y="630" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#E9D5FF">3. Return</text>
  
  <!-- Key insight -->
  <rect x="60" y="1000" width="960" height="40" fill="#27272A" rx="8"/>
  <text x="540" y="1027" font-family="system-ui, sans-serif" font-size="14" fill="#A1A1AA" text-anchor="middle">Context switch: Save user registers → Switch to kernel stack → Execute → Restore user registers</text>
  
  <text x="540" y="1060" font-family="system-ui, sans-serif" font-size="14" fill="#52525B" text-anchor="middle">@devweekends</text>
</svg>
