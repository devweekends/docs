<svg viewBox="0 0 1080 1080" xmlns="http://www.w3.org/2000/svg">
  <rect width="1080" height="1080" fill="#FAFAFA"/>
  
  <!-- Branding -->
  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#18181B" letter-spacing="3">DEV WEEKENDS</text>
  
  <!-- Title -->
  <text x="540" y="140" font-family="system-ui, sans-serif" font-size="36" font-weight="700" fill="#18181B" text-anchor="middle">Linux Networking Stack</text>
  <text x="540" y="175" font-family="system-ui, sans-serif" font-size="18" fill="#71717A" text-anchor="middle">Packet journey through the kernel: sk_buff, sockets, and network layers</text>
  
  <!-- Packet Flow Visualization -->
  <!-- User Space -->
  <rect x="80" y="210" width="920" height="80" rx="12" fill="#22C55E" opacity="0.2" stroke="#22C55E" stroke-width="2"/>
  <text x="150" y="245" font-family="system-ui, sans-serif" font-size="16" fill="#22C55E" font-weight="600">User Space</text>
  
  <rect x="300" y="225" width="150" height="50" rx="8" fill="#22C55E"/>
  <text x="375" y="255" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Application</text>
  
  <rect x="480" y="225" width="180" height="50" rx="8" fill="#FAFAFA" stroke="#22C55E" stroke-width="2"/>
  <text x="570" y="250" font-family="system-ui, sans-serif" font-size="11" fill="#22C55E" font-weight="600" text-anchor="middle">send()/recv()</text>
  <text x="570" y="268" font-family="monospace" font-size="10" fill="#18181B" text-anchor="middle">socket(AF_INET, SOCK_STREAM)</text>
  
  <rect x="690" y="225" width="200" height="50" rx="8" fill="#3B82F6"/>
  <text x="790" y="255" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Socket FD â†’ struct sock</text>
  
  <path d="M540 295 L540 315" stroke="#18181B" stroke-width="3" marker-end="url(#arrow)"/>
  
  <!-- Socket Layer -->
  <rect x="80" y="320" width="920" height="100" rx="12" fill="#3B82F6" opacity="0.1" stroke="#3B82F6" stroke-width="2"/>
  <text x="150" y="355" font-family="system-ui, sans-serif" font-size="16" fill="#3B82F6" font-weight="600">Socket Layer</text>
  
  <rect x="300" y="340" width="280" height="65" rx="8" fill="#3B82F6"/>
  <text x="440" y="365" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">struct socket / struct sock</text>
  <text x="440" y="385" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">sk_receive_queue, sk_write_queue</text>
  <text x="440" y="400" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">proto_ops (tcp_prot, udp_prot)</text>
  
  <rect x="610" y="340" width="280" height="65" rx="8" fill="#FAFAFA" stroke="#3B82F6" stroke-width="2"/>
  <text x="750" y="365" font-family="system-ui, sans-serif" font-size="12" fill="#3B82F6" font-weight="600" text-anchor="middle">Socket Buffers (sk_buff)</text>
  <text x="750" y="385" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">data, head, tail, end pointers</text>
  <text x="750" y="400" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">Protocol headers, payload reference</text>
  
  <path d="M540 425 L540 445" stroke="#18181B" stroke-width="3" marker-end="url(#arrow)"/>
  
  <!-- Transport Layer -->
  <rect x="80" y="450" width="920" height="100" rx="12" fill="#A855F7" opacity="0.1" stroke="#A855F7" stroke-width="2"/>
  <text x="150" y="485" font-family="system-ui, sans-serif" font-size="16" fill="#A855F7" font-weight="600">Transport (L4)</text>
  
  <rect x="300" y="465" width="200" height="70" rx="8" fill="#A855F7"/>
  <text x="400" y="490" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">TCP</text>
  <text x="400" y="510" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">tcp_v4_rcv(), tcp_sendmsg()</text>
  <text x="400" y="525" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Congestion, retransmit</text>
  
  <rect x="520" y="465" width="160" height="70" rx="8" fill="#A855F7" opacity="0.8"/>
  <text x="600" y="490" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">UDP</text>
  <text x="600" y="510" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">udp_rcv()</text>
  <text x="600" y="525" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">No connection state</text>
  
  <rect x="700" y="465" width="190" height="70" rx="8" fill="#FAFAFA" stroke="#A855F7" stroke-width="2"/>
  <text x="795" y="490" font-family="system-ui, sans-serif" font-size="12" fill="#A855F7" font-weight="600" text-anchor="middle">Port Demux</text>
  <text x="795" y="510" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">inet_hashtables</text>
  <text x="795" y="525" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">5-tuple â†’ socket lookup</text>
  
  <path d="M540 555 L540 575" stroke="#18181B" stroke-width="3" marker-end="url(#arrow)"/>
  
  <!-- Network Layer -->
  <rect x="80" y="580" width="920" height="100" rx="12" fill="#EF4444" opacity="0.1" stroke="#EF4444" stroke-width="2"/>
  <text x="150" y="615" font-family="system-ui, sans-serif" font-size="16" fill="#EF4444" font-weight="600">Network (L3)</text>
  
  <rect x="300" y="595" width="180" height="70" rx="8" fill="#EF4444"/>
  <text x="390" y="620" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA" font-weight="600" text-anchor="middle">IPv4 / IPv6</text>
  <text x="390" y="640" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">ip_rcv(), ip_output()</text>
  <text x="390" y="655" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Routing decisions</text>
  
  <rect x="500" y="595" width="180" height="70" rx="8" fill="#FAFAFA" stroke="#EF4444" stroke-width="2"/>
  <text x="590" y="620" font-family="system-ui, sans-serif" font-size="12" fill="#EF4444" font-weight="600" text-anchor="middle">Netfilter</text>
  <text x="590" y="640" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">iptables, nftables hooks</text>
  <text x="590" y="655" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">PREROUTING, FORWARD, etc</text>
  
  <rect x="700" y="595" width="190" height="70" rx="8" fill="#EF4444" opacity="0.8"/>
  <text x="795" y="620" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Routing Table (FIB)</text>
  <text x="795" y="640" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">ip_route_input()</text>
  <text x="795" y="655" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">LPM lookup</text>
  
  <path d="M540 685 L540 705" stroke="#18181B" stroke-width="3" marker-end="url(#arrow)"/>
  
  <!-- Link Layer -->
  <rect x="80" y="710" width="920" height="100" rx="12" fill="#18181B" opacity="0.1" stroke="#18181B" stroke-width="2"/>
  <text x="150" y="745" font-family="system-ui, sans-serif" font-size="16" fill="#18181B" font-weight="600">Link (L2)</text>
  
  <rect x="300" y="725" width="180" height="70" rx="8" fill="#18181B"/>
  <text x="390" y="750" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">net_device</text>
  <text x="390" y="770" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">eth0, lo, veth, bridge</text>
  <text x="390" y="785" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">net_device_ops</text>
  
  <rect x="500" y="725" width="180" height="70" rx="8" fill="#FAFAFA" stroke="#18181B" stroke-width="2"/>
  <text x="590" y="750" font-family="system-ui, sans-serif" font-size="12" fill="#18181B" font-weight="600" text-anchor="middle">ARP / NDP</text>
  <text x="590" y="770" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">Neighbor cache</text>
  <text x="590" y="785" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">IP â†’ MAC resolution</text>
  
  <rect x="700" y="725" width="190" height="70" rx="8" fill="#22C55E"/>
  <text x="795" y="750" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">Traffic Control (tc)</text>
  <text x="795" y="770" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">qdisc: HTB, fq, pfifo</text>
  <text x="795" y="785" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Shaping, policing</text>
  
  <path d="M540 815 L540 835" stroke="#18181B" stroke-width="3" marker-end="url(#arrow)"/>
  
  <!-- Driver/Hardware -->
  <rect x="80" y="840" width="920" height="70" rx="12" fill="#3B82F6"/>
  <text x="150" y="875" font-family="system-ui, sans-serif" font-size="16" fill="#FAFAFA" font-weight="600">Driver / NIC</text>
  
  <rect x="300" y="850" width="150" height="45" rx="6" fill="#FAFAFA"/>
  <text x="375" y="878" font-family="system-ui, sans-serif" font-size="11" fill="#3B82F6" font-weight="600" text-anchor="middle">NAPI polling</text>
  
  <rect x="470" y="850" width="150" height="45" rx="6" fill="#FAFAFA"/>
  <text x="545" y="878" font-family="system-ui, sans-serif" font-size="11" fill="#3B82F6" font-weight="600" text-anchor="middle">Ring Buffers</text>
  
  <rect x="640" y="850" width="150" height="45" rx="6" fill="#FAFAFA"/>
  <text x="715" y="878" font-family="system-ui, sans-serif" font-size="11" fill="#3B82F6" font-weight="600" text-anchor="middle">DMA</text>
  
  <rect x="810" y="850" width="150" height="45" rx="6" fill="#FAFAFA"/>
  <text x="885" y="878" font-family="system-ui, sans-serif" font-size="11" fill="#3B82F6" font-weight="600" text-anchor="middle">Interrupts/MSI-X</text>
  
  <!-- Key insight -->
  <rect x="80" y="930" width="920" height="70" rx="10" fill="#A855F7" opacity="0.15" stroke="#A855F7" stroke-width="2"/>
  <text x="120" y="960" font-family="system-ui, sans-serif" font-size="14" fill="#A855F7" font-weight="600">ðŸ’¡ Key Insight:</text>
  <text x="250" y="960" font-family="system-ui, sans-serif" font-size="13" fill="#18181B">sk_buff is THE core data structure - one per packet, passed through all layers.</text>
  <text x="120" y="985" font-family="system-ui, sans-serif" font-size="12" fill="#71717A">Pointers (head, data, tail) shift as headers are added/removed â€¢ Zero-copy where possible â€¢ GRO/GSO for batching</text>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#18181B"/>
    </marker>
  </defs>
  
  <!-- Footer -->
  <text x="540" y="1040" font-family="system-ui, sans-serif" font-size="14" fill="#71717A" text-anchor="middle">@devweekends</text>
</svg>