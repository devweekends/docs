<svg viewBox="0 0 1080 1080" xmlns="http://www.w3.org/2000/svg">
  <rect width="1080" height="1080" fill="#FAFAFA"/>
  
  <!-- Branding -->
  <text x="60" y="80" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#18181B" letter-spacing="3">DEV WEEKENDS</text>
  
  <!-- Title -->
  <text x="540" y="140" font-family="system-ui, sans-serif" font-size="36" font-weight="700" fill="#18181B" text-anchor="middle">Linux Memory Management</text>
  <text x="540" y="175" font-family="system-ui, sans-serif" font-size="18" fill="#71717A" text-anchor="middle">Virtual memory, buddy allocator, slab/SLUB, and page tables</text>
  
  <!-- Virtual Address Space -->
  <rect x="80" y="210" width="300" height="400" rx="16" fill="#3B82F6" opacity="0.1" stroke="#3B82F6" stroke-width="2"/>
  <text x="230" y="245" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="#3B82F6" text-anchor="middle">Virtual Address Space</text>
  <text x="230" y="265" font-family="system-ui, sans-serif" font-size="11" fill="#71717A" text-anchor="middle">(Per-process, 128 TB on x86_64)</text>
  
  <!-- Stack -->
  <rect x="110" y="285" width="240" height="45" rx="6" fill="#EF4444"/>
  <text x="230" y="308" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" text-anchor="middle">Stack ↓</text>
  <text x="230" y="322" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">0x7FFFFFFFFFFF</text>
  
  <!-- mmap region -->
  <rect x="110" y="340" width="240" height="55" rx="6" fill="#A855F7"/>
  <text x="230" y="365" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" text-anchor="middle">Memory Mapped Region</text>
  <text x="230" y="380" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Shared libs, mmap(), malloc(large)</text>
  
  <!-- Heap -->
  <rect x="110" y="405" width="240" height="55" rx="6" fill="#22C55E"/>
  <text x="230" y="430" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" text-anchor="middle">Heap ↑</text>
  <text x="230" y="445" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">brk()/sbrk(), malloc(small)</text>
  
  <!-- BSS and Data -->
  <rect x="110" y="470" width="115" height="40" rx="6" fill="#18181B"/>
  <text x="167" y="495" font-family="system-ui, sans-serif" font-size="11" fill="#FAFAFA" text-anchor="middle">BSS</text>
  
  <rect x="235" y="470" width="115" height="40" rx="6" fill="#18181B"/>
  <text x="292" y="495" font-family="system-ui, sans-serif" font-size="11" fill="#FAFAFA" text-anchor="middle">Data</text>
  
  <!-- Text -->
  <rect x="110" y="520" width="240" height="45" rx="6" fill="#3B82F6"/>
  <text x="230" y="545" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" text-anchor="middle">Text (Code)</text>
  <text x="230" y="558" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">0x400000</text>
  
  <text x="230" y="595" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">Kernel Space (upper half)</text>
  
  <!-- Page Table (4-level) -->
  <rect x="410" y="210" width="280" height="400" rx="16" fill="#22C55E" opacity="0.1" stroke="#22C55E" stroke-width="2"/>
  <text x="550" y="245" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="#22C55E" text-anchor="middle">4-Level Page Table (x86_64)</text>
  
  <!-- Virtual address breakdown -->
  <rect x="430" y="270" width="240" height="50" rx="6" fill="#18181B"/>
  <text x="550" y="290" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Virtual Address (48 bits used)</text>
  <rect x="440" y="300" width="40" height="15" fill="#EF4444"/>
  <rect x="485" y="300" width="40" height="15" fill="#A855F7"/>
  <rect x="530" y="300" width="40" height="15" fill="#3B82F6"/>
  <rect x="575" y="300" width="40" height="15" fill="#22C55E"/>
  <rect x="620" y="300" width="50" height="15" fill="#71717A"/>
  <text x="460" y="328" font-family="system-ui, sans-serif" font-size="8" fill="#18181B" text-anchor="middle">PGD</text>
  <text x="505" y="328" font-family="system-ui, sans-serif" font-size="8" fill="#18181B" text-anchor="middle">PUD</text>
  <text x="550" y="328" font-family="system-ui, sans-serif" font-size="8" fill="#18181B" text-anchor="middle">PMD</text>
  <text x="595" y="328" font-family="system-ui, sans-serif" font-size="8" fill="#18181B" text-anchor="middle">PTE</text>
  <text x="645" y="328" font-family="system-ui, sans-serif" font-size="8" fill="#18181B" text-anchor="middle">Offset</text>
  
  <!-- Translation steps -->
  <rect x="430" y="350" width="55" height="40" rx="4" fill="#EF4444"/>
  <text x="457" y="375" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">PGD</text>
  <path d="M490 370 L510 370" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="515" y="350" width="55" height="40" rx="4" fill="#A855F7"/>
  <text x="542" y="375" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">PUD</text>
  <path d="M575 370 L595 370" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="600" y="350" width="55" height="40" rx="4" fill="#3B82F6"/>
  <text x="627" y="375" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">PMD</text>
  
  <path d="M550 395 L550 415" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="430" y="420" width="230" height="40" rx="4" fill="#22C55E"/>
  <text x="545" y="445" font-family="system-ui, sans-serif" font-size="11" fill="#FAFAFA" text-anchor="middle">PTE → Physical Frame + Offset</text>
  
  <!-- TLB note -->
  <rect x="430" y="480" width="240" height="50" rx="8" fill="#FAFAFA" stroke="#EF4444" stroke-width="2"/>
  <text x="550" y="500" font-family="system-ui, sans-serif" font-size="12" fill="#EF4444" font-weight="600" text-anchor="middle">TLB (Translation Lookaside Buffer)</text>
  <text x="550" y="520" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">Cache for page table entries - ~4 cycles vs ~400</text>
  
  <!-- CR3 register -->
  <rect x="430" y="545" width="240" height="40" rx="6" fill="#18181B"/>
  <text x="550" y="565" font-family="system-ui, sans-serif" font-size="11" fill="#FAFAFA" text-anchor="middle">CR3 Register → Points to PGD</text>
  <text x="550" y="580" font-family="system-ui, sans-serif" font-size="9" fill="#71717A" text-anchor="middle">Context switch = CR3 change = TLB flush</text>
  
  <!-- Buddy Allocator and SLUB -->
  <rect x="720" y="210" width="280" height="400" rx="16" fill="#A855F7" opacity="0.1" stroke="#A855F7" stroke-width="2"/>
  <text x="860" y="245" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="#A855F7" text-anchor="middle">Physical Memory Allocators</text>
  
  <!-- Buddy Allocator -->
  <text x="860" y="280" font-family="system-ui, sans-serif" font-size="14" fill="#18181B" font-weight="600" text-anchor="middle">Buddy Allocator (Pages)</text>
  
  <rect x="740" y="295" width="240" height="25" rx="4" fill="#A855F7"/>
  <text x="860" y="312" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Order 0: 4KB (single page)</text>
  
  <rect x="740" y="325" width="120" height="22" rx="4" fill="#A855F7"/>
  <rect x="865" y="325" width="115" height="22" rx="4" fill="#A855F7" opacity="0.7"/>
  <text x="860" y="340" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">Order 1: 8KB (2 pages)</text>
  
  <rect x="740" y="352" width="60" height="20" rx="4" fill="#A855F7"/>
  <rect x="805" y="352" width="55" height="20" rx="4" fill="#A855F7" opacity="0.8"/>
  <rect x="865" y="352" width="55" height="20" rx="4" fill="#A855F7" opacity="0.6"/>
  <rect x="925" y="352" width="55" height="20" rx="4" fill="#A855F7" opacity="0.4"/>
  <text x="860" y="385" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">Split and merge to avoid fragmentation</text>
  
  <!-- SLUB -->
  <text x="860" y="420" font-family="system-ui, sans-serif" font-size="14" fill="#18181B" font-weight="600" text-anchor="middle">SLUB Allocator (Objects)</text>
  
  <rect x="740" y="435" width="240" height="80" rx="8" fill="#FAFAFA" stroke="#22C55E" stroke-width="2"/>
  <text x="860" y="458" font-family="system-ui, sans-serif" font-size="11" fill="#22C55E" font-weight="600" text-anchor="middle">kmem_cache (e.g., task_struct)</text>
  
  <rect x="755" y="470" width="30" height="30" rx="4" fill="#22C55E"/>
  <rect x="790" y="470" width="30" height="30" rx="4" fill="#22C55E"/>
  <rect x="825" y="470" width="30" height="30" rx="4" fill="#22C55E" opacity="0.5"/>
  <rect x="860" y="470" width="30" height="30" rx="4" fill="#22C55E" opacity="0.3"/>
  <rect x="895" y="470" width="30" height="30" rx="4" fill="#22C55E" opacity="0.3"/>
  <rect x="930" y="470" width="30" height="30" rx="4" fill="#22C55E" opacity="0.3"/>
  
  <text x="860" y="530" font-family="system-ui, sans-serif" font-size="10" fill="#18181B" text-anchor="middle">Pre-allocated objects for fast allocation</text>
  <text x="860" y="545" font-family="system-ui, sans-serif" font-size="10" fill="#71717A" text-anchor="middle">Per-CPU caches to avoid locking</text>
  
  <!-- API comparison -->
  <rect x="740" y="560" width="240" height="45" rx="6" fill="#18181B"/>
  <text x="800" y="580" font-family="monospace" font-size="10" fill="#22C55E">kmalloc()</text>
  <text x="870" y="580" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA">General purpose</text>
  <text x="800" y="598" font-family="monospace" font-size="10" fill="#A855F7">vmalloc()</text>
  <text x="870" y="598" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA">Large, non-contiguous</text>
  
  <!-- Key concepts bottom -->
  <rect x="80" y="630" width="920" height="100" rx="12" fill="#18181B"/>
  <text x="120" y="665" font-family="system-ui, sans-serif" font-size="16" fill="#22C55E" font-weight="600">Key Memory Concepts:</text>
  
  <text x="120" y="695" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA">Copy-on-Write (COW):</text>
  <text x="270" y="695" font-family="system-ui, sans-serif" font-size="12" fill="#71717A">fork() shares pages, copies only on write</text>
  
  <text x="540" y="695" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA">Page Fault:</text>
  <text x="630" y="695" font-family="system-ui, sans-serif" font-size="12" fill="#71717A">Demand paging, allocate on access</text>
  
  <text x="120" y="718" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA">Huge Pages:</text>
  <text x="220" y="718" font-family="system-ui, sans-serif" font-size="12" fill="#71717A">2MB/1GB pages, reduce TLB misses</text>
  
  <text x="540" y="718" font-family="system-ui, sans-serif" font-size="13" fill="#FAFAFA">OOM Killer:</text>
  <text x="635" y="718" font-family="system-ui, sans-serif" font-size="12" fill="#71717A">Kills processes when memory exhausted</text>
  
  <!-- mm_struct visualization -->
  <rect x="80" y="750" width="920" height="200" rx="16" fill="#3B82F6" opacity="0.1" stroke="#3B82F6" stroke-width="2"/>
  <text x="540" y="785" font-family="system-ui, sans-serif" font-size="18" font-weight="600" fill="#3B82F6" text-anchor="middle">mm_struct: Per-Process Memory Descriptor</text>
  
  <!-- VMA list -->
  <rect x="120" y="810" width="200" height="60" rx="8" fill="#3B82F6"/>
  <text x="220" y="835" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">vm_area_struct (VMA)</text>
  <text x="220" y="855" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">vm_start, vm_end, vm_prot</text>
  
  <path d="M325 840 L360 840" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="365" y="810" width="200" height="60" rx="8" fill="#3B82F6" opacity="0.8"/>
  <text x="465" y="835" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">VMA (heap)</text>
  <text x="465" y="855" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">RW, anonymous</text>
  
  <path d="M570 840 L605 840" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="610" y="810" width="200" height="60" rx="8" fill="#3B82F6" opacity="0.6"/>
  <text x="710" y="835" font-family="system-ui, sans-serif" font-size="12" fill="#FAFAFA" font-weight="600" text-anchor="middle">VMA (libc.so)</text>
  <text x="710" y="855" font-family="system-ui, sans-serif" font-size="10" fill="#FAFAFA" text-anchor="middle">RX, file-backed</text>
  
  <path d="M815 840 L850 840" stroke="#18181B" stroke-width="2" marker-end="url(#arrow)"/>
  
  <text x="900" y="845" font-family="system-ui, sans-serif" font-size="16" fill="#18181B">...</text>
  
  <text x="540" y="910" font-family="system-ui, sans-serif" font-size="12" fill="#71717A" text-anchor="middle">VMAs stored in Red-Black tree for O(log n) lookup • mmap()/munmap() modify VMA list</text>
  <text x="540" y="930" font-family="system-ui, sans-serif" font-size="11" fill="#18181B" text-anchor="middle">/proc/[pid]/maps shows all VMAs for a process</text>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#18181B"/>
    </marker>
  </defs>
  
  <!-- Footer -->
  <text x="540" y="1040" font-family="system-ui, sans-serif" font-size="14" fill="#71717A" text-anchor="middle">@devweekends</text>
</svg>