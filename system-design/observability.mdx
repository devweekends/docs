---
title: "Observability & Monitoring"
description: "Building observable systems for production debugging"
icon: "chart-line"
---

<Warning>
**Senior Level**: Observability is how you debug production issues. Interviewers expect senior engineers to design systems that can be understood and debugged at scale.
</Warning>

## The Three Pillars of Observability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              The Three Pillars                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  METRICS                    LOGS                  TRACES        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€        â”‚
â”‚  "What happened?"           "Why?"                "Where?"      â”‚
â”‚                                                                 â”‚
â”‚  Aggregated data            Individual events     Request flow  â”‚
â”‚  Time-series               Text/structured       Distributed    â”‚
â”‚  Cheap to store            Expensive             Moderate       â”‚
â”‚  Alerting                  Debugging             Root cause     â”‚
â”‚                                                                 â”‚
â”‚  Examples:                  Examples:             Examples:      â”‚
â”‚  â€¢ Request rate             â€¢ Error messages      â€¢ Request path â”‚
â”‚  â€¢ Error rate               â€¢ Stack traces        â€¢ Latency/span â”‚
â”‚  â€¢ Latency (p50,p99)        â€¢ User actions        â€¢ Dependencies â”‚
â”‚  â€¢ CPU/Memory               â€¢ Audit trail         â€¢ Bottlenecks  â”‚
â”‚                                                                 â”‚
â”‚  Tools:                     Tools:                Tools:        â”‚
â”‚  â€¢ Prometheus               â€¢ ELK Stack           â€¢ Jaeger       â”‚
â”‚  â€¢ Datadog                  â€¢ Splunk              â€¢ Zipkin       â”‚
â”‚  â€¢ CloudWatch               â€¢ CloudWatch Logs     â€¢ AWS X-Ray    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Metrics

### Key Metrics to Track (RED Method)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RED Method (Request-focused)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  R - Rate      : Requests per second                           â”‚
â”‚  E - Errors    : Error rate (% of failed requests)             â”‚
â”‚  D - Duration  : Request latency (p50, p95, p99)               â”‚
â”‚                                                                 â”‚
â”‚  For every service, track:                                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Service: payment-service                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚   â”‚
â”‚  â”‚  Rate:      150 req/s                                   â”‚   â”‚
â”‚  â”‚  Errors:    0.1% (5xx), 2% (4xx)                        â”‚   â”‚
â”‚  â”‚  Duration:  p50=45ms, p95=120ms, p99=350ms              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### USE Method (Resource-focused)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              USE Method (Infrastructure)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  U - Utilization : % time resource is busy                     â”‚
â”‚  S - Saturation  : Work resource can't service (queue length)  â”‚
â”‚  E - Errors      : Count of error events                       â”‚
â”‚                                                                 â”‚
â”‚  Apply to each resource:                                       â”‚
â”‚                                                                 â”‚
â”‚  CPU:                                                          â”‚
â”‚  â€¢ Utilization: 75%                                            â”‚
â”‚  â€¢ Saturation: Load average / CPU count                        â”‚
â”‚  â€¢ Errors: CPU errors (rare)                                   â”‚
â”‚                                                                 â”‚
â”‚  Memory:                                                        â”‚
â”‚  â€¢ Utilization: Used / Total                                   â”‚
â”‚  â€¢ Saturation: Swap usage, OOM events                          â”‚
â”‚  â€¢ Errors: Allocation failures                                 â”‚
â”‚                                                                 â”‚
â”‚  Network:                                                       â”‚
â”‚  â€¢ Utilization: Bandwidth used                                 â”‚
â”‚  â€¢ Saturation: Dropped packets, retransmits                    â”‚
â”‚  â€¢ Errors: Interface errors                                    â”‚
â”‚                                                                 â”‚
â”‚  Disk:                                                          â”‚
â”‚  â€¢ Utilization: I/O time %                                     â”‚
â”‚  â€¢ Saturation: I/O queue length                                â”‚
â”‚  â€¢ Errors: Bad sectors, I/O errors                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Metric Types

```python
from prometheus_client import Counter, Gauge, Histogram, Summary

# COUNTER: Only goes up (request count, errors)
requests_total = Counter(
    'http_requests_total',
    'Total HTTP requests',
    ['method', 'endpoint', 'status']
)

# GAUGE: Can go up and down (current connections, queue size)
active_connections = Gauge(
    'active_connections',
    'Number of active connections'
)

# HISTOGRAM: Measures distribution (latency buckets)
request_latency = Histogram(
    'http_request_duration_seconds',
    'Request latency in seconds',
    ['endpoint'],
    buckets=[0.01, 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0]
)

# SUMMARY: Like histogram but calculates quantiles client-side
request_latency_summary = Summary(
    'http_request_duration_summary',
    'Request latency summary',
    ['endpoint']
)

# Usage in request handler
@app.middleware("http")
async def metrics_middleware(request, call_next):
    start = time.time()
    
    active_connections.inc()
    try:
        response = await call_next(request)
        return response
    finally:
        duration = time.time() - start
        active_connections.dec()
        
        requests_total.labels(
            method=request.method,
            endpoint=request.url.path,
            status=response.status_code
        ).inc()
        
        request_latency.labels(
            endpoint=request.url.path
        ).observe(duration)
```

## Distributed Tracing

### How Tracing Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Distributed Trace                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Trace ID: abc123 (unique per request)                         â”‚
â”‚                                                                 â”‚
â”‚  API Gateway                                                    â”‚
â”‚  â”œâ”€ Span 1: gateway (trace_id=abc123, span_id=001)             â”‚
â”‚  â”‚  â”‚ start: 0ms, duration: 150ms                              â”‚
â”‚  â”‚  â”‚                                                          â”‚
â”‚  â”‚  â”œâ”€ Span 2: auth-service (parent=001, span_id=002)         â”‚
â”‚  â”‚  â”‚  â”‚ start: 5ms, duration: 20ms                           â”‚
â”‚  â”‚  â”‚  â””â”€ tags: {user_id: "usr_123"}                          â”‚
â”‚  â”‚  â”‚                                                          â”‚
â”‚  â”‚  â”œâ”€ Span 3: order-service (parent=001, span_id=003)        â”‚
â”‚  â”‚  â”‚  â”‚ start: 30ms, duration: 100ms                         â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚
â”‚  â”‚  â”‚  â”œâ”€ Span 4: database (parent=003, span_id=004)          â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ start: 35ms, duration: 45ms                       â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€ tags: {query: "SELECT..."}                       â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚
â”‚  â”‚  â”‚  â””â”€ Span 5: payment-service (parent=003, span_id=005)   â”‚
â”‚  â”‚  â”‚     â”‚ start: 85ms, duration: 40ms                       â”‚
â”‚  â”‚  â”‚     â””â”€ tags: {amount: 150.00}                           â”‚
â”‚  â”‚  â”‚                                                          â”‚
â”‚  â”‚  â””â”€ Span 6: notification (parent=001, span_id=006)         â”‚
â”‚  â”‚     â”‚ start: 135ms, duration: 10ms                         â”‚
â”‚  â”‚     â””â”€ tags: {type: "email"}                               â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€ Total: 150ms                                               â”‚
â”‚                                                                 â”‚
â”‚  Visualized:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ gateway                                              â”‚     â”‚
â”‚  â”‚  â”œâ”€authâ”€â”€â”¤                                           â”‚     â”‚
â”‚  â”‚      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€order-serviceâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚     â”‚
â”‚  â”‚      â”‚   â”œâ”€â”€â”€â”€databaseâ”€â”€â”€â”€â”¤                      â”‚   â”‚     â”‚
â”‚  â”‚      â”‚                    â”œâ”€â”€â”€â”€paymentâ”€â”€â”€â”€â”¤      â”‚   â”‚     â”‚
â”‚  â”‚                                              â”œâ”€notifâ”€â”¤     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  0ms      25ms      50ms      75ms      100ms     125ms 150ms â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Implementing Tracing

```python
from opentelemetry import trace
from opentelemetry.trace.propagation import set_span_in_context
from opentelemetry.propagate import inject, extract

tracer = trace.get_tracer(__name__)

# Propagate context through HTTP headers
async def call_service(service_url: str, payload: dict, headers: dict):
    # Get current context and inject trace headers
    inject(headers)
    
    async with httpx.AsyncClient() as client:
        return await client.post(service_url, json=payload, headers=headers)

# Start a new span
@app.post("/orders")
async def create_order(request: Request, order: OrderCreate):
    # Extract context from incoming request
    context = extract(dict(request.headers))
    
    with tracer.start_as_current_span("create_order", context=context) as span:
        # Add attributes (searchable in UI)
        span.set_attribute("user_id", order.user_id)
        span.set_attribute("order_total", order.total)
        
        # Child span for database
        with tracer.start_as_current_span("db.insert_order") as db_span:
            db_span.set_attribute("db.system", "postgresql")
            db_span.set_attribute("db.statement", "INSERT INTO orders...")
            order_id = await db.insert_order(order)
        
        # Child span for external service
        with tracer.start_as_current_span("payment.charge") as pay_span:
            pay_span.set_attribute("payment.amount", order.total)
            try:
                await call_service(
                    f"http://payment-service/charge",
                    {"amount": order.total},
                    {}
                )
            except Exception as e:
                pay_span.record_exception(e)
                pay_span.set_status(trace.Status(trace.StatusCode.ERROR))
                raise
        
        return {"order_id": order_id}
```

## Structured Logging

### Log Format Best Practices

```python
import structlog
import logging
from datetime import datetime

# Configure structured logging
structlog.configure(
    processors=[
        structlog.processors.TimeStamper(fmt="iso"),
        structlog.processors.add_log_level,
        structlog.processors.JSONRenderer()
    ]
)

logger = structlog.get_logger()

# Good: Structured, searchable, includes context
logger.info(
    "order_created",
    order_id="ord_123",
    user_id="usr_456",
    total=150.00,
    items_count=3,
    trace_id="abc123",
    duration_ms=45
)
# Output: {"event": "order_created", "order_id": "ord_123", 
#          "user_id": "usr_456", "total": 150.00, ...}

# Bad: Unstructured, hard to search
logger.info(f"Order ord_123 created for user usr_456 with total $150.00")
```

### Log Levels

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Log Level Guidelines                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  DEBUG   â”‚ Detailed diagnostic info                            â”‚
â”‚          â”‚ Use: Development, troubleshooting                   â”‚
â”‚          â”‚ Example: "Cache key: user:123, value: {...}"        â”‚
â”‚          â”‚                                                      â”‚
â”‚  INFO    â”‚ Normal operations                                   â”‚
â”‚          â”‚ Use: Track key events                               â”‚
â”‚          â”‚ Example: "Order created", "User logged in"          â”‚
â”‚          â”‚                                                      â”‚
â”‚  WARNING â”‚ Potential issues (but still working)                â”‚
â”‚          â”‚ Use: Things that should be investigated             â”‚
â”‚          â”‚ Example: "Rate limit approaching", "Retry succeeded"â”‚
â”‚          â”‚                                                      â”‚
â”‚  ERROR   â”‚ Operation failed (but service continues)            â”‚
â”‚          â”‚ Use: Failed requests, exceptions                    â”‚
â”‚          â”‚ Example: "Payment failed", "DB connection timeout"  â”‚
â”‚          â”‚                                                      â”‚
â”‚  FATAL   â”‚ Service is unusable                                 â”‚
â”‚          â”‚ Use: Critical failures requiring immediate action   â”‚
â”‚          â”‚ Example: "Database unreachable", "Config missing"   â”‚
â”‚                                                                 â”‚
â”‚  PRODUCTION LOG LEVELS:                                        â”‚
â”‚  â€¢ Default: INFO and above                                     â”‚
â”‚  â€¢ Per-service override for debugging                          â”‚
â”‚  â€¢ Never DEBUG in production (too verbose, costly)             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Correlation IDs

```python
from contextvars import ContextVar
import uuid

# Context variable for request correlation
correlation_id_ctx: ContextVar[str] = ContextVar('correlation_id')

class CorrelationMiddleware:
    """
    Ensures every request has a correlation ID
    """
    
    async def __call__(self, request, call_next):
        # Get from header or generate new
        correlation_id = request.headers.get(
            'X-Correlation-ID',
            str(uuid.uuid4())
        )
        
        # Set in context for logging
        correlation_id_ctx.set(correlation_id)
        
        # Process request
        response = await call_next(request)
        
        # Add to response headers
        response.headers['X-Correlation-ID'] = correlation_id
        return response

# Logger automatically includes correlation ID
class CorrelationLogger:
    def _log(self, level, message, **kwargs):
        kwargs['correlation_id'] = correlation_id_ctx.get(None)
        structlog.get_logger().log(level, message, **kwargs)
    
    def info(self, message, **kwargs):
        self._log('info', message, **kwargs)
    
    def error(self, message, **kwargs):
        self._log('error', message, **kwargs)
```

## Alerting

### Alert Design Principles

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Alerting Best Practices                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  GOOD ALERT:                                                    â”‚
â”‚  â€¢ Actionable (someone needs to do something)                  â”‚
â”‚  â€¢ Urgent (needs attention within SLA)                         â”‚
â”‚  â€¢ Clear (describes what's wrong and impact)                   â”‚
â”‚  â€¢ Rare (not noisy, doesn't cause alert fatigue)               â”‚
â”‚                                                                 â”‚
â”‚  BAD ALERT:                                                     â”‚
â”‚  â€¢ "CPU at 80%" (so what? is anything broken?)                 â”‚
â”‚  â€¢ Fires frequently (causes alert fatigue)                     â”‚
â”‚  â€¢ No clear action (what should I do?)                         â”‚
â”‚                                                                 â”‚
â”‚  ALERT ON SYMPTOMS, NOT CAUSES:                                â”‚
â”‚                                                                 â”‚
â”‚  âŒ BAD:  "Database CPU > 90%"                                 â”‚
â”‚  âœ… GOOD: "Order creation latency > 2s for 5 minutes"         â”‚
â”‚                                                                 â”‚
â”‚  Why? The symptom (slow orders) is what matters to users.      â”‚
â”‚  High CPU that doesn't affect users isn't urgent.              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Alert Template

```yaml
# Example PagerDuty/Opsgenie Alert
alert: OrderServiceHighLatency
expr: histogram_quantile(0.99, rate(order_request_duration_seconds_bucket[5m])) > 2
for: 5m
labels:
  severity: critical
  service: order-service
  team: payments
annotations:
  summary: "Order service p99 latency is {{ $value }}s (threshold: 2s)"
  description: |
    Impact: Users are experiencing slow checkout.
    
    Dashboard: https://grafana.example.com/d/orders
    Runbook: https://wiki.example.com/runbooks/order-latency
    
    Possible causes:
    - Database connection pool exhausted
    - Payment service slow
    - Increased traffic
    
    Immediate actions:
    1. Check dashboard for traffic spike
    2. Check payment-service health
    3. Check database metrics
  runbook_url: https://wiki.example.com/runbooks/order-latency
```

### Alert Severity Levels

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Severity Levels                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  SEV-1 (Critical) - Page immediately, all hands                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚  â€¢ Service is down                                             â”‚
â”‚  â€¢ Data loss occurring                                         â”‚
â”‚  â€¢ Security breach                                             â”‚
â”‚  Response: 15 minutes                                          â”‚
â”‚                                                                 â”‚
â”‚  SEV-2 (High) - Page on-call                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚  â€¢ Major feature degraded                                      â”‚
â”‚  â€¢ Significant latency increase                                â”‚
â”‚  â€¢ Error rate > 5%                                             â”‚
â”‚  Response: 30 minutes                                          â”‚
â”‚                                                                 â”‚
â”‚  SEV-3 (Medium) - Ticket, fix during business hours            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚  â€¢ Non-critical feature broken                                 â”‚
â”‚  â€¢ Performance degradation (not severe)                        â”‚
â”‚  Response: 4 hours                                             â”‚
â”‚                                                                 â”‚
â”‚  SEV-4 (Low) - Ticket, fix when convenient                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚  â€¢ Minor issues                                                â”‚
â”‚  â€¢ Cosmetic problems                                           â”‚
â”‚  Response: 1 week                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Dashboards

### Dashboard Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Dashboard Layout                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  TOP: High-level health (GREEN/YELLOW/RED)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸŸ¢ API Gateway  ğŸŸ¢ Orders  ğŸŸ¡ Payments  ğŸŸ¢ Database    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  GOLDEN SIGNALS (RED method):                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Request Rate    â”‚ â”‚ Error Rate      â”‚ â”‚ Latency p99     â”‚  â”‚
â”‚  â”‚     ğŸ“ˆ          â”‚ â”‚     ğŸ“‰          â”‚ â”‚     ğŸ“Š          â”‚  â”‚
â”‚  â”‚  1,234 req/s    â”‚ â”‚    0.05%        â”‚ â”‚    145ms        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  RESOURCE UTILIZATION (USE method):                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ CPU             â”‚ â”‚ Memory          â”‚ â”‚ Disk I/O        â”‚  â”‚
â”‚  â”‚     â–‚â–ƒâ–…â–†â–‡       â”‚ â”‚     â–ƒâ–ƒâ–ƒâ–ƒâ–ƒ       â”‚ â”‚     â–â–‚â–â–‚â–       â”‚  â”‚
â”‚  â”‚    65%          â”‚ â”‚    72%          â”‚ â”‚    15%          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  DEPENDENCIES:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Payment API: 50ms â”‚ Database: 10ms â”‚ Redis: 1ms        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  BOTTOM: Detailed graphs, logs, traces                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## SLIs, SLOs, and SLAs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SLI / SLO / SLA                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  SLI (Service Level Indicator)                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  The metric you measure                                        â”‚
â”‚  Example: "99th percentile latency of API requests"            â”‚
â”‚                                                                 â”‚
â”‚  SLO (Service Level Objective)                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  The target you aim for (internal)                             â”‚
â”‚  Example: "99th percentile latency < 200ms"                    â”‚
â”‚                                                                 â”‚
â”‚  SLA (Service Level Agreement)                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  The contract with customers (external)                        â”‚
â”‚  Example: "99.9% availability or refund"                       â”‚
â”‚  Note: SLA should be looser than SLO (buffer)                  â”‚
â”‚                                                                 â”‚
â”‚  Example SLO Document:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Service: Order API                                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚   â”‚
â”‚  â”‚  Availability: 99.95% of requests successful            â”‚   â”‚
â”‚  â”‚  Latency: 99% of requests < 500ms                       â”‚   â”‚
â”‚  â”‚  Throughput: Handle 10,000 req/s                        â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  Error Budget: 0.05% = 21.6 minutes/month               â”‚   â”‚
â”‚  â”‚  Current Budget Remaining: 15.3 minutes                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Senior Interview Questions

<Accordion title="How do you debug a latency spike in production?">
**Systematic approach**:
1. **Check dashboards**: RED metrics, identify when it started
2. **Correlate**: Deployments? Traffic spike? Dependency issue?
3. **Trace analysis**: Find slow spans in traces
4. **Log analysis**: Search for errors around that time
5. **Narrow down**: Which endpoint? Which users?

**Common causes**:
- Database slow queries (check slow query log)
- GC pauses (check GC metrics)
- Connection pool exhaustion
- External dependency slowdown
- Lock contention
</Accordion>

<Accordion title="How do you set up monitoring for a new service?">
**Checklist**:
1. **Instrument code**: Add metrics (RED method)
2. **Add tracing**: Propagate trace context
3. **Structured logging**: With correlation IDs
4. **Create dashboard**: Health, golden signals, resources
5. **Set up alerts**: On symptoms, not causes
6. **Document SLOs**: Define success criteria
7. **Create runbooks**: What to do when alerts fire
</Accordion>

<Accordion title="What's your approach to reducing alert fatigue?">
**Strategies**:
1. **Alert on symptoms**: User impact, not causes
2. **Use thresholds wisely**: 5 minutes > 80% vs instant spike
3. **Group related alerts**: One page per incident, not 10
4. **Regular review**: Delete unused, tune noisy alerts
5. **Escalation policy**: Low-priority â†’ ticket, high â†’ page
6. **On-call feedback**: Track alert quality metrics

**Key metric**: If on-call is paged but no action needed, fix the alert!
</Accordion>

<Accordion title="How would you design a metrics system at scale?">
**Architecture**:
1. **Collection**: Agent on each host (Prometheus, StatsD)
2. **Aggregation**: Pre-aggregate at edge (reduce cardinality)
3. **Storage**: Time-series DB (InfluxDB, M3DB, Thanos)
4. **Query**: Federation for cross-cluster queries
5. **Visualization**: Grafana dashboards

**Scale challenges**:
- High cardinality labels (user_id) â†’ Aggregate
- Long retention â†’ Downsampling
- Many metrics â†’ Drop unused
</Accordion>
